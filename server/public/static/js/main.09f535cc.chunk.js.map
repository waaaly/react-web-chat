{"version":3,"sources":["App/layout/Chat/ChatStore/ChatStore.tsx","common/constant.ts","App/httpClientRequest/http.ts","App/utils/operatorLocalStorage.ts","App/httpClientRequest/useApi.ts","App/store/GlobalStore.tsx","App/utils/loadable.tsx","App/router/index.ts","App/layout/Chat/WeChatHeader/index.tsx","App/components/MyBadge/index.tsx","App/layout/Chat/SideUserList/components/UserItem/index.tsx","App/layout/Chat/SideUserList/index.tsx","App/httpClientRequest/netcloundApi.ts","App/pages/NetClound/NCLogin/index.tsx","App/pages/NetClound/NCPlayList/index.tsx","App/httpClientRequest/miguMusicApi.ts","App/httpClientRequest/qqMusicApi.ts","App/pages/NetClound/SongTool/index.tsx","App/pages/NetClound/NCSongList/index.tsx","App/httpClientRequest/audioApi.ts","App/layout/Chat/ChatPlayer/color-thief.js","App/layout/Chat/ChatPlayer/index.tsx","App/layout/Chat/ChatGame/games/tetris/index.tsx","App/layout/Chat/ChatGame/index.tsx","App/utils/index.ts","App/components/globalContext.tsx","App/layout/Chat/ChatMain/index.tsx","App/layout/Login/index.tsx","App/layout/Register/index.tsx","App/index.tsx","serviceWorker.ts","index.tsx"],"names":["state","userId","nickname","avatar","currentRecords","recordsListRef","React","createRef","createStore","chat","storeContext","createContext","ChatStoreProvider","children","store","useLocalStore","Provider","value","useChatStore","useContext","Error","siteName","apiIp","socketIp","netcloundIP","MiGuMusicIP","QQMusicIP","sideWidth","axios","create","timeout","defaults","headers","post","httpCode","400","401","403","404","500","501","502","504","useRequest","url","config","useState","loading","setLoading","globalStore","useGlobalStore","router","useHistory","request","useCallback","params","pathParams","a","requestUrl","authorization","getToken","console","log","method","response","data","tips","status","message","error","logout","push","Promise","reject","localStorage","getItem","setToken","token","setItem","removeToken","removeItem","setNetCloundId","uid","getNetCloundId","useLogin","useRegister","useGetAvatar","useSetAvatar","useMyInfo","useUserInfo","useRoomRecords","usePrivateRecords","useGetFacebag","useDeleteFacebag","useGetMusic","userInfo","allUserList","user","socket","io","this","StoreProvider","LoadingComponent","props","NProgress","start","done","Component","routes","path","exact","auth","component","loader","Loadable","loadable","WeChatHeader","visible","setVisible","avatarList","setAvatarList","curAvatar","setCurAvatar","getAvatar","setAvatar","uploadProp","name","multiple","showUploadList","action","Authorization","onChange","e","file","filename","list","nickName","res","success","className","title","centered","onCancel","onOk","setAvatarRequest","cancelButtonProps","style","display","width","map","item","cursor","margin","border","key","onClick","src","onClickAvatar","size","icon","PlusOutlined","openModal","alt","MyBadge","UserItem","observer","chatStore","getAllRoomRecords","getPrivateRecords","chatTo","includes","emit","unreadMessage","allRoomRecords","privateRecords","isOnline","latestMessage","time","type","abstract","hasMedia","valueRaw","BraftEditor","createEditorState","toRAW","i","blocks","length","text","replace","slice","entityMap","showMessage","SideUserList","useEffect","useGetSongUrl","useGetSongLrc","useGetCloundSearch","useGetSongDetail","NCLogin","destroyOnClose","visiable","okButtonProps","setVisiable","QRLogin","timer","qrCode","qrImg","setQrImg","tipMsg","setTipMsg","getQrkey","getQrBase64","getCheckQr","getStatus","createQr","timerstamp","Date","now","keyRes","unikey","qrimg","qrRes","checkQrTimer","setInterval","checkRes","code","clearInterval","useInfo","account","id","NCPlayList","getUserPlayList","playList","setPlayList","curPlayList","setCurPlayList","playlist","bodyStyle","minHeight","maxHeight","overflowY","hoverable","cover","coverImgUrl","actions","tags","trackCount","playCount","Meta","creator","avatarUrl","description","PlayListDetail","curPlayListId","onBack","columns","dataIndex","render","ar","al","min","parseInt","dt","sec","Math","ceil","CaretRightOutlined","onClickPlay","VerticalAlignBottomOutlined","onClickDownload","getSongDetail","getPlayListDetail","getSongUrl","getSongLrc","playListDetail","setPlayListDetail","getUrl","getLrc","lrc","lyric","getAudio","ids","song","songs","artist","picUrl","theme","audio","player","add","subTitle","rowKey","dataSource","tracks","useMgGetSearch","useQQGetSearch","SongTool","forwardRef","ref","getNcSearch","getMgSearch","getQQSearch","getNcUrl","getMgUrl","getQQUrl","getNcLrc","getQQLrc","SearchSong","songList","keywords","result","forEach","albumname","keyword","album","artists","singer","songmid","songname","SongUrl","Number","cid","SongLrc","lyuic","useImperativeHandle","NCSongList","child","DailySong","setList","getSongList","createAudio","onClickAddList","setTimeout","index","audios","switch","play","warn","dailySongs","itemLayout","header","renderItem","Item","holderText","setHolderText","searchKey","setSearchKey","SongToolRef","setSongList","current","info","defaultActiveKey","TabPane","tab","Search","placeholder","onSearch","enterButton","CanvasImage","image","removeCanvas","canvas","parentNode","removeChild","document","createElement","context","getContext","body","appendChild","height","drawImage","clearRect","imageData","putImageData","getImageData","ColorThief","values","reduce","sourceImage","quality","getPalette","colorCount","offset","r","g","b","pixels","pixelCount","getPixelCount","pixelArray","cmap","MMCQ","quantize","palette","imageUrl","resolve","thief","addEventListener","dominantColor","xhr","XMLHttpRequest","open","responseType","onload","uInt8Array","Uint8Array","binaryString","Array","String","fromCharCode","join","base64","window","btoa","send","then","getColorFromUrl","pv","array","f","o","d","call","naturalOrder","sum","p","max","apply","getColorIndex","PQueue","comparator","contents","sorted","sort","peek","undefined","pop","debug","VBox","r1","r2","g1","g2","b1","b2","histo","CMap","vboxes","vbox","count","volume","medianCutApply","rw","gw","bw","maxw","copy","j","k","total","partialsum","lookaheadsum","doCut","color","left","right","vbox1","vbox2","d2","dim1","dim2","count2","prototype","force","_volume","_count_set","npix","_count","avg","_avg","hval","ntot","rsum","gsum","bsum","contains","pixel","rval","gval","bval","vb","nearest","d1","pColor","sqrt","pow","forcebw","lowest","idx","highest","maxcolors","getHisto","nColors","rmin","rmax","gmin","gmax","bmin","bmax","vboxFromPixels","pq","iter","lh","target","ncolors","niters","pq2","ChatPlayer","option","mini","autoplay","loop","preload","mutex","listFolded","listMaxHeight","lrcType","getMusic","getAudioList","ncLogin","setNclogin","ncPlayList","setNcPlayList","ncSongList","setNcSongList","songListChild","setSongListChild","setPlayer","ap","APlayer","container","getElementById","on","colorThief","img","catch","err","setTheme","musicList","audioList","Tetris","t","grid","setGrid","countX","countY","downTime","boxSize","aWay","delayTime","share","s","c","n","scorres","useRef","cruActive","cruFinish","skewing","downIndex","canButton","getActiveGrid","filter","concat","getAcitveColor","gInit","tGird","show","x","y","checkCanChange","ns","cb","e1","changeAway","away","checkAway","ca","cs","py","cas","split","z","newS","changeDown","oneGridFinish","ncas","obj","checkClear","makeNew","xca","findIndex","splice","h1","e2","ramIndex","floor","random","zs","ex","ey","keydown","cruAn","nb","changeShare","backgroundColor","CharGame","gamesOption","label","radioValue","setRadioValue","radioLabel","setRadioLabel","Group","options","optionType","placement","onClose","background","generateUUID","getTime","toString","globalContext","GlobalUser","Sider","Content","ChatMain","globalUser","GlobalContext","getUserInfo","getAllUser","listChange","chatRoom","_id","fromId","toId","groupItem","latestMessageNickname","userAgent","navigator","isOpera","indexOf","isIE","isIE11","isEdge","_beforeUnload_time","onunload","onbeforeunload","close","marginLeft","Login","loginRequest","loginSubmit","password","md5","resData","onFinish","rules","required","autoComplete","validator","rule","test","Password","htmlType","Register","registerRequest","registerSubmit","withRouter","globalInfo","setGlobalInfo","preventDefault","to","ChatStore","Boolean","location","hostname","match","ReactDOM","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.09f535cc.chunk.js","sourcesContent":["import React from 'react';\nimport {useLocalStore} from 'mobx-react-lite';\n\ninterface chatState {\n  /* 当前选中用户 id */\n  userId: string,\n  /* 当前选中用户昵称 */\n  nickname: string,\n  /* 当前选中用户头像 */\n  avatar: string\n  /* 当前聊天内容 */\n  currentRecords: any[],\n  /* 聊天内容列表ref */\n  recordsListRef: any,\n}\n\nlet state: chatState = {\n  userId: '',\n  nickname: '',\n  avatar: '',\n  currentRecords: [],\n  recordsListRef: React.createRef(),\n};\n\ninterface chatStore {\n  chat: chatState\n}\n\nfunction createStore() {\n  return {\n    chat: state,\n  };\n}\n\nconst storeContext = React.createContext<chatStore>({} as any);\n\n\nexport const ChatStoreProvider = ({children}: { children: any }) => {\n  const store = useLocalStore(createStore);\n  return <storeContext.Provider value={store}> {children}</storeContext.Provider>;\n};\n\nexport const useChatStore = (): chatStore => {\n  const store: chatStore = React.useContext(storeContext);\n  if (!store) {\n    throw new Error('useStore must be used within a StoreProvider');\n  }\n  return store;\n};\n\n\n","/*\n * @Description: \n * @Author: waaaly\n * @Github: https://github.com/waaaly\n * @Date: 2021-10-20 16:39:07\n * @LastEditTime: 2021-10-21 15:09:07\n */\nconst siteName: string = 'WebChat';\nconst footerText: string = 'WebChat 版权所有 © 2021 由 waaaly 支持';\nconst apiIp: string = 'http://1.12.246.138:3000';\nconst socketIp: string = 'http://1.12.246.138:4000';\nconst netcloundIP: string =\n    process.env.NODE_ENV === 'development' ?\n        'http://localhost:3000/netclound'\n        : 'http://1.12.246.138:3000/netclound';\nconst MiGuMusicIP: string =\n    process.env.NODE_ENV === 'development' ?\n        'http://localhost:3000/migumusic'\n        : 'http://1.12.246.138:3000/migumusic';\nconst QQMusicIP: string =\n    process.env.NODE_ENV === 'development' ?\n        'http://localhost:3000/qqmusic'\n        : 'http://1.12.246.138:3000/qqmusic';\nconst sideWidth: number = 400;\n\nexport { siteName, footerText, apiIp, socketIp, sideWidth, netcloundIP, MiGuMusicIP, QQMusicIP };","import axios from 'axios';\nimport { message } from 'antd';\nimport { getToken } from \"@/App/utils/operatorLocalStorage\";\nimport { useCallback, useState } from 'react';\nimport { useGlobalStore } from \"@/App/store/GlobalStore\";\nimport { useHistory } from 'react-router-dom';\n\nconst instance = axios.create({    //创建axios实例，在这里可以设置请求的默认配置\n  timeout: 3000,\n  // baseURL: process.env.NODE_ENV === 'production' ? '' : '/api',   //根据自己配置的反向代理去设置不同环境的baeUrl\n});\n// 文档中的统一设置post请求头。\ninstance.defaults.headers.post['Content-Type'] = 'application/json';\n// delete 请求头\n// instance.defaults.headers.delete['Content-Type'] = 'application/x-www-form-urlencoded';\n\nlet httpCode: { [propName: number]: string } = {        // 这里我简单列出一些常见的http状态码信息，可以自己去调整配置\n  400: '请求参数错误',\n  401: '权限不足, 请重新登录',\n  403: '服务器拒绝本次访问',\n  404: '请求资源未找到',\n  500: '内部服务器错误',\n  501: '服务器不支持该请求中使用的方法',\n  502: '网关错误',\n  504: '网关超时'\n};\n\nexport const useRequest = (url: string, config: any) => {\n  const [loading, setLoading] = useState(false);\n  const globalStore = useGlobalStore();\n  const router = useHistory();\n  const request = useCallback(async (params?: any, pathParams?: string | number) => {\n    const requestUrl = pathParams ? `${url}/${pathParams}` : url;\n    const authorization = getToken();\n    if (authorization) {\n      /*\n        此处有坑，在此记录\n        request.headers['Authorization']\n        必须通过此种形式设置Authorization,否则后端即使收到字段也会出现问题，返回401\n        - request.headers.Authorization或request.headers.authorization可以设置成功，\n        浏览器查看也没有任何问题，但是在后端会报401并且后端一律只能拿到小写的，\n        也就是res.headers.authorization，后端用大写获取会报undefined\n      */\n      axios.defaults.headers['Authorization'] = authorization;\n    } else {\n      delete axios.defaults.headers['Authorization'];\n    }\n    //防止调用5000的netclound跨域\n    // axios.defaults.withCredentials = true\n    setLoading(true);\n    let response;\n    try {\n      console.log(requestUrl, params)\n      if (config.method === 'get') {\n        response = await axios({\n          url: requestUrl,\n          params,\n          ...config\n        });\n\n      } else {\n        response = await axios({\n          url: requestUrl,\n          data: params,\n          ...config\n        });\n      }\n      return response;\n    } catch (error) {\n      if (error.response) {\n        // 根据请求失败的http状态码去给用户相应的提示\n        let tips = error.response.status in httpCode ? httpCode[error.response.status] : error.response.data.message;\n        message.error(tips);\n        if (error.response.status === 401) {\n          globalStore.logout();\n          router.push('/login');\n        }\n        return Promise.reject(tips);\n      } else {\n        message.error('请求超时，请刷新重试');\n        return Promise.reject('请求超时，请刷新重试');\n      }\n    } finally {\n      setLoading(false);\n    }\n\n  }, [url, config]);\n  return { request, loading };\n};\n","// 保存在 localStorage 中的 token 字段名\nconst TokenKey: string = 'authorization';\n// 保存在 localStorage 中的 active 字段名\nconst ActiveKey: string = 'chatUserActive';\nconst netcloundUserId:string = 'netclounduserid'\n/**\n * 获取 token\n */\nexport function getToken(): string {\n  return localStorage.getItem(TokenKey) as string;\n}\n\n/**\n * 设置 token\n * @param token:string\n */\nexport function setToken(token: string): void {\n  return localStorage.setItem(TokenKey, token);\n}\n\n/**\n * 移除 token\n */\nexport function removeToken(): void {\n  return localStorage.removeItem(TokenKey);\n}\n\n/**\n * 设置当前聊天用户的 id\n * @param active\n */\nexport function setChatUserActive(active: string): void {\n  return localStorage.setItem(ActiveKey, active);\n}\n\n/**\n * 获取当前聊天用户的 id\n */\nexport function getChatUserActive(): string {\n  return localStorage.getItem(ActiveKey) as string;\n}\n\n/**\n * 设置网易云账号id\n */\n export function setNetCloundId(uid: string): void {\n  return localStorage.setItem(netcloundUserId, uid);\n}\n/**\n * 获取网易云账号id\n */\n export function getNetCloundId(): string {\n  return localStorage.getItem(netcloundUserId) as string;\n}","/*\n * @Description: \n * @Author: waaaly\n * @Github: https://github.com/waaaly\n * @Date: 2021-10-20 16:39:07\n * @LastEditTime: 2021-10-25 09:51:10\n */\nimport { useRequest } from './http';\n\nimport { apiIp } from \"@/common/constant\";\n\n/*\n* 用户登录\n* @param {Object} params 登录参数\n* @requestMethod POST\n* */\nexport const useLogin = () => useRequest(`${apiIp}/api/login`, { method: 'post' });\n\n/*\n* 用户注册\n* @param {Object} params 注册参数\n* @requestMethod POST\n* */\nexport const useRegister = () => useRequest(`${apiIp}/api/register`, { method: 'post' });\n\n/*\n* 获取用户注册时所需头像\n* @requestMethod POST\n* */\nexport const useGetAvatar = () => useRequest(`${apiIp}/api/getAvatar`, { method: 'get' });\n\n/**\n * 修改用户头像\n * @requestMethod POST\n */\n\nexport const useSetAvatar = () => useRequest(`${apiIp}/api/setavatar`, { method: \"post\" })\n\n/**\n * 用户上传头像\n * @requestMethod POST\n */\n\n export const useUploadAvatar = () => useRequest(`${apiIp}/api/uploadAvatar`, { method: \"post\" })\n\n/*\n* 获取个人信息\n* @requestMethod GET\n* */\nexport const useMyInfo = () => useRequest(`${apiIp}/api/getUserInfo`, { method: 'get' });\n\n/*\n* 获取所有用户信息\n* @requestMethod GET\n* */\nexport const useUserInfo = () => useRequest(`${apiIp}/api/getAllUser`, { method: 'get' });\n\n\n/*\n* 获取群聊天记录\n* @requestMethod GET\n* */\nexport const useRoomRecords = () => useRequest(`${apiIp}/api/getRoomRecords`, { method: 'get' });\n\n/*\n* 获取私人聊天记录\n* @requestMethod GET\n* */\nexport const usePrivateRecords = () => useRequest(`${apiIp}/api/getPrivateRecords`, { method: 'get' });\n\n/**\n * 获取表情包\n */\nexport const useGetFacebag = () => useRequest(`${apiIp}/api/getFacebag`, { method: 'get' });\n\n/**\n * 删除单个表情包\n */\nexport const useDeleteFacebag = () => useRequest(`${apiIp}/api/deleteFacebag`, { method: 'delete' });\n\n/**\n * 获取服务器本地歌曲\n */\nexport const useGetMusic = () => useRequest(`${apiIp}/api/getMusic`, { method: 'get' });","/*\n * @Description: \n * @Author: waaaly\n * @Github: https://github.com/waaaly\n * @Date: 2021-10-20 16:39:07\n * @LastEditTime: 2021-10-21 15:02:51\n */\nimport React from 'react';\nimport {useLocalStore} from 'mobx-react-lite';\nimport {getToken, removeToken} from \"@/App/utils/operatorLocalStorage\";\nimport io from 'socket.io-client';\nimport {socketIp} from \"@/common/constant\";\n\n\ninterface userInfo {\n  userId: string,\n  nickname: string,\n  avatar: string\n}\n\ninterface userState {\n  token: string,\n  userInfo: userInfo,\n  allUserList: any[],\n}\n\nlet state: userState = {\n  token: getToken(),\n  userInfo: {\n    userId: '',\n    nickname: '',\n    avatar: ''\n  },\n  allUserList: [],\n};\n\ninterface userStore {\n  user: userState,\n  socket: any,\n\n  logout(): void\n}\n\nfunction createStore(): userStore {\n  return {\n    user: state,\n    socket: io(socketIp),\n    logout(): void {\n      removeToken();\n      this.user.token = '';\n    }\n  };\n}\n\nconst storeContext = React.createContext<userStore>({} as any);\n\n\nexport const StoreProvider = ({children}: { children: any }) => {\n  const store = useLocalStore(createStore);\n  return <storeContext.Provider value={store}> {children}</storeContext.Provider>;\n};\n\nexport const useGlobalStore = (): userStore => {\n  const store: any = React.useContext(storeContext);\n  if (!store) {\n    throw new Error('useStore must be used within a StoreProvider');\n  }\n  return store;\n};\n\n\n","import React, {Component} from 'react';\nimport Loadable, { LoadingComponentProps } from 'react-loadable';\nimport NProgress from 'nprogress';\nimport 'nprogress/nprogress.css';\n\n\nclass LoadingComponent extends Component<LoadingComponentProps> {\n  constructor(props: Readonly<Loadable.LoadingComponentProps>) {\n\n    super(props);\n    NProgress.start();\n  }\n\n  componentDidMount() {\n    NProgress.done();\n  }\n\n  render() {\n    return <div />;\n  }\n}\n\n// TODO 组件类型写什么\nexport default (loader: any, loading = LoadingComponent) => {\n  return Loadable({\n    loader,\n    loading\n  });\n}\n","import loadable from \"@/App/utils/loadable\";\n\nconst ChatContent = loadable(() => import('@/App/pages/ChatContent'));\n\ninterface Route {\n  path: string,\n  exact: boolean,\n  auth: boolean,\n  component: any\n}\n\nconst routes: Array<Route> = [\n  {path: '/', exact: true, auth: true, component: ChatContent},\n];\n\nexport default routes;\n","/*\n * @Description: \n * @Author: waaaly\n * @Github: https://github.com/waaaly\n * @Date: 2021-10-20 16:39:07\n * @LastEditTime: 2021-10-25 13:51:58\n */\nimport React, { useState ,useEffect} from 'react';\nimport './index.less';\nimport { useHistory } from 'react-router';\nimport { useGlobalStore } from \"@/App/store/GlobalStore\";\nimport { useGetAvatar, useSetAvatar } from \"@/App/httpClientRequest/useApi\";\nimport { Observer } from 'mobx-react-lite';\nimport { message, Modal, Avatar, Upload } from \"antd\";\nimport { PlusOutlined } from '@ant-design/icons';\nimport { getToken } from '@/App/utils/operatorLocalStorage';\n/**\n * 公共头部\n *\n */\n\nfunction WeChatHeader(props) {\n    const globalStore = useGlobalStore();\n    const router = useHistory();\n    const [visible, setVisible] = useState(false);\n    const [avatarList, setAvatarList] = useState<string[]>([]);\n    const [curAvatar, setCurAvatar] = useState(globalStore.user.userInfo.avatar)\n    const { request: getAvatar } = useGetAvatar();\n    const { request: setAvatar } = useSetAvatar();\n    \n    const uploadProp = {\n        name: 'avatar',\n        multiple: true,\n        showUploadList: false,\n        action: \"http://1.12.246.138:3000/api/uploadAvatar\",\n        headers: {\n            Authorization: getToken(),\n        },\n        onChange: (e: { file: any; }) => {\n            console.log(e)\n            let { file } = e\n            if (file.status === 'done') {\n                let { filename } = file.response\n                console.log(filename)\n                let list: string[] = [...avatarList]\n                list.push(`http://1.12.246.138:4000/avatar/${filename}`)\n                setAvatarList(list)\n            }\n        }\n    }\n\n\n    function onClickAvatar(src:string) {\n        setCurAvatar(src)\n    }\n    async function openModal() {\n        let list = (await getAvatar()).data.data;\n        setAvatarList(list.avatarList)\n        setVisible(true)\n    }\n    async function setAvatarRequest() {\n        console.log(curAvatar, globalStore.user.userInfo.nickname)\n        if (curAvatar !== '' && curAvatar !== globalStore.user.userInfo.avatar) {\n            let res = await setAvatar({\n                nickName: globalStore.user.userInfo.nickname,\n                avatar: curAvatar\n            })\n            props.method(res)\n            message.success(res.data.message)\n        }\n        setVisible(false)\n    }\n\n    return (\n        <Observer>\n            {() =>\n                <div className=\"chat-header-wrapper\">\n                    <Modal\n                        title=\"头像选择\"\n                        centered\n                        visible={visible}\n                        onCancel={() => setVisible(false)}\n                        onOk={() => setAvatarRequest()}\n                        cancelButtonProps={{ style: { display: 'none' } }}\n                        width={1000}\n                    >\n                        <div>\n                            {\n                                avatarList.map(item => {\n                                    return (\n                                        <div style={{ cursor: 'pointer', display: 'inline-block', margin: '10px', border: `2px solid ${curAvatar === item ? '#1890ff' : 'transparent '}` }} key={item} onClick={() => onClickAvatar(item)}>\n                                            <Avatar size={80} src={item} />\n                                        </div>\n                                    )\n                                })\n                            }\n                            <Upload {...uploadProp}>\n                                <div style={{cursor: 'pointer', display: 'inline-block', margin: '10px', border: '2px solid transparent' }}>\n                                    <Avatar size={80} icon={<PlusOutlined  />} />\n                                </div>\n                            </Upload>\n                        </div>\n                    </Modal>\n                    <div className=\"user-info-show\">\n                        <div className=\"user-info\">\n                            <img className='user-avatar' onClick={() => { openModal() }} src={globalStore.user.userInfo.avatar} alt=\"\" />\n                            <span className=\"nickname\">{globalStore.user.userInfo.nickname}</span>\n                        </div>\n                        <div className=\"user-operator\">\n                            <ul className=\"operator-list\">\n                                <li className=\"operator-item\" onClick={async () => {\n                                    globalStore.logout();\n                                    router.push(\"/\");\n                                    message.success('退出成功');\n                                }\n                                }>退出登录\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                </div>\n            }\n        </Observer>\n\n    );\n}\n\nexport default WeChatHeader;","import React from 'react';\nimport './index.less';\n\nfunction MyBadge(props) {\n  return (\n    <div className=\"my-badge\">\n      {props.children}\n    </div>\n  );\n}\n\nexport default MyBadge;\n","import React from 'react';\nimport './index.less';\nimport { observer } from 'mobx-react-lite';\nimport { useChatStore } from \"@/App/layout/Chat/ChatStore/ChatStore\";\nimport { useGlobalStore } from \"@/App/store/GlobalStore\";\nimport MyBadge from \"@/App/components/MyBadge\";\nimport { useRoomRecords } from \"@/App/httpClientRequest/useApi\";\nimport { usePrivateRecords } from \"@/App/httpClientRequest/useApi\";\nimport BraftEditor from 'braft-editor';\n\n/**\n * 用户项\n * 包括姓名，头像，是否在线，未读消息数\n */\n\ninterface Props {\n  /* 当前选中项用户 id */\n  userId: string,\n  /* 当前选中项用户昵称 */\n  nickname: string,\n  /* 当前选中项用户头像 */\n  avatar: string,\n  /* 当前选中项用户是否在线 */\n  isOnline: boolean,\n  /* 未读消息数 */\n  unreadMessage: number,\n  /* 最近的一条消息 */\n  latestMessage: Message,\n  /* 最近一条消息的时间 */\n  latestMessageTime: string,\n}\ninterface Message {\n  /* 消息的内容 */\n  message: string,\n  /* 消息的时间 */\n  type: string,\n  /* 消息的时间 */\n  time: string,\n}\nconst UserItem = observer((props: Props) => {\n  const chatStore = useChatStore();\n  const globalStore = useGlobalStore();\n  const { request: getAllRoomRecords } = useRoomRecords();\n  const { request: getPrivateRecords } = usePrivateRecords();\n\n  const chatTo = async () => {\n    const { userId, nickname, avatar } = props;\n    chatStore.chat.userId = userId;\n    chatStore.chat.nickname = nickname;\n    chatStore.chat.avatar = avatar;\n    if (userId.includes('group')) { // 群聊\n      globalStore.socket.emit('clearGroupUnreadMessage', { 'userId': globalStore.user.userInfo.userId });\n      globalStore.user.allUserList[0].unreadMessage = 0;\n      chatStore.chat.currentRecords = (await getAllRoomRecords()).data.data.allRoomRecords;\n    } else { // 私聊\n      globalStore.socket.emit('clearPrivateUnreadMessage', {\n        'userId': globalStore.user.userInfo.userId,\n        'fromId': userId,\n      });\n      for (let item of globalStore.user.allUserList) {\n        if (item.userId === userId) {\n          item.unreadMessage = 0;\n        }\n      }\n      chatStore.chat.currentRecords = (await getPrivateRecords({ 'fromId': userId })).data.data.privateRecords;\n    }\n    // setChatUserActive(userId);\n  };\n\n  const showMessage = (message: Message) => {\n    switch (message.type) {\n      case 'img': return '[图片]';\n      case 'facebag': return '[动画表情]';\n      default:\n        let abstract = '', hasMedia = false;\n        let valueRaw = BraftEditor.createEditorState(message.message).toRAW(true);\n        for (let i = 0; i < valueRaw.blocks.length; i++) {\n          if (valueRaw.blocks[i].text && valueRaw.blocks[i].type !== 'atomic') {\n            abstract += (valueRaw.blocks[i].text).replace(/<\\/?.+?>/g, \"\").replace(/[\\r\\n]/g, \"\");\n            if (abstract.length > 50) {\n              abstract = abstract.slice(0, 50) + '……';\n              break;\n            }\n          }\n        }\n        for (let key in valueRaw.entityMap) {\n          if (valueRaw.entityMap[key].type !== 'EMBED') {\n            hasMedia = true;\n            break;\n          }\n        }\n        return abstract || (hasMedia && '[图片]')\n    }\n  }\n\n  return (\n    <li className={`user-list-item${props.userId === chatStore.chat.userId ? ' active' : ''}`} onClick={chatTo}>\n      <div className={`avatar avatar-${props.isOnline ? 'online' : 'offline'}`}>\n        <img src={props.avatar} alt=\"\" />\n      </div>\n      <div className=\"contacts-content\">\n        <div className=\"contacts-info\">\n          <span className=\"chat-name\">{props.nickname}</span>\n          <div className=\"chat-time\">{props.latestMessage.time}</div>\n        </div>\n        <div className=\"contacts-texts\">\n          <p className=\"text-truncate\">{showMessage(props.latestMessage)} </p>\n          {\n            props.unreadMessage !== 0 ? <MyBadge>{props.unreadMessage}</MyBadge> : null\n          }\n        </div>\n      </div>\n    </li>\n  );\n});\n\nexport default UserItem;","import React, {useEffect} from 'react';\nimport './index.less';\nimport {observer} from 'mobx-react-lite';\nimport UserItem from \"@/App/layout/Chat/SideUserList/components/UserItem\";\n\n/**\n * 左侧菜单\n *\n */\n\ninterface Props {\n  allUserList: any[]\n}\n\nconst SideUserList = observer((props: Props) => {\n\n  useEffect(() => {\n\n  });\n\n  return (\n    <ul className=\"all-user-list hidden-scrollbar\">\n      {\n        props.allUserList.map((item) => {\n          return (\n            <UserItem\n              key={item.userId + item.time}\n              {...item}\n            />);\n        })\n      }\n    </ul>\n  );\n});\n\nexport default SideUserList;","import { useRequest } from './http';\r\n\r\nimport { netcloundIP } from \"@/common/constant\";\r\n\r\n\r\n/** \r\n * 获取一个二维码登录的key  \r\n */\r\nexport const useGetQrKey = () => useRequest(`${netcloundIP}/login/qr/key`, { method: 'get' });\r\n\r\n/**\r\n * 根据key生成二维码\r\n */\r\nexport const useGetQrBase64 = () => useRequest(`${netcloundIP}/login/qr/create`, { method: 'get' });\r\n\r\n/**\r\n * 检查二维码是否过期\r\n */\r\nexport const useGetCheckQr = () => useRequest(`${netcloundIP}/login/qr/check`, { method: 'get' });\r\n\r\n/**\r\n * 获取登录状态\r\n */\r\nexport const useGetStatus = () => useRequest(`${netcloundIP}/login/status`, { method: 'get' });\r\n\r\n/**\r\n * 获取用户详情 /user/playlist\r\n */\r\nexport const useGetUserDetail = () => useRequest(`${netcloundIP}/user/detail`, { method: 'get' });\r\n\r\n/**\r\n * 获取用户歌单\r\n */\r\nexport const useGetUserPlayList = () => useRequest(`${netcloundIP}/user/playlist`, { method: 'get' });\r\n\r\n\r\n/**\r\n * 获取歌单详情\r\n */\r\n export const useGetPlayListDetail = () => useRequest(`${netcloundIP}/playlist/detail`, { method: 'get' });\r\n/**\r\n * 获取用户用户日推列表\r\n */\r\nexport const useGetSongList = () => useRequest(`${netcloundIP}/recommend/songs`, { method: 'get' });\r\n\r\n/**\r\n * 获取歌曲url\r\n */\r\n\r\nexport const useGetSongUrl = () => useRequest(`${netcloundIP}/song/url`, { method: 'get' });\r\n\r\n/**\r\n * 获取歌曲/lyric\r\n */\r\nexport const useGetSongLrc = () => useRequest(`${netcloundIP}/lyric`, { method: 'get' });\r\n\r\n/**\r\n * 默认单曲搜索 cloudsearch\r\n */\r\nexport const useGetCloundSearch = () => useRequest(`${netcloundIP}/cloudsearch`, { method: 'get' });\r\n\r\n/**\r\n * 获取歌曲详情\r\n */\r\nexport const useGetSongDetail = () => useRequest(`${netcloundIP}/song/detail`, { method: 'get' });\r\n\r\n/**\r\n * 批量请求接口\r\n */\r\n export const useBatchRequest = () => useRequest(`${netcloundIP}/batch`, { method: 'post' });","import React, { useState, useEffect } from \"react\"\r\nimport { Modal } from 'antd'\r\nimport { useGetQrKey, useGetQrBase64, useGetCheckQr, useGetStatus } from '@/App/httpClientRequest/netcloundApi';\r\nimport { setNetCloundId } from \"@/App/utils/operatorLocalStorage\";\r\nimport './index.less'\r\nexport function NCLogin(props) {\r\n\r\n    return (\r\n        <Modal\r\n            title={`登录网易云`}\r\n            centered={true}\r\n            destroyOnClose={true}\r\n            visible={props.visiable}\r\n            cancelButtonProps={{ style: { display: 'none' } }}\r\n            okButtonProps={{ style: { display: 'none' } }}\r\n            width={800}\r\n            onCancel={() => { props.setVisiable() }}\r\n        >\r\n            <QRLogin />\r\n        </Modal>\r\n    )\r\n}\r\n\r\nexport function QRLogin() {\r\n    const [qrImg, setQrImg] = useState('http://1.12.246.138:4000/picture/loading.gif');\r\n    const [tipMsg, setTipMsg] = useState('使用网易云App扫码登录')\r\n    const { request: getQrkey } = useGetQrKey()\r\n    const { request: getQrBase64 } = useGetQrBase64()\r\n    const { request: getCheckQr } = useGetCheckQr()\r\n    const { request: getStatus } = useGetStatus()\r\n    let timer: any, qrCode: any;\r\n\r\n    async function createQr() {\r\n        let keyRes = (await getQrkey({ timerstamp: Date.now() })).data.data;\r\n        console.log(keyRes)\r\n        let qrRes = (await getQrBase64({\r\n            key: keyRes.unikey,\r\n            qrimg: true,\r\n            timerstamp: Date.now()\r\n        })).data.data;\r\n        console.log(qrRes)\r\n        setQrImg(qrRes.qrimg)\r\n        checkQrTimer(keyRes.unikey)\r\n    }\r\n\r\n    function checkQrTimer(key) {\r\n        timer = setInterval(async () => {\r\n            let checkRes = (await getCheckQr({ key, timerstamp: Date.now() })).data;\r\n            console.log(checkRes)\r\n            setTipMsg(checkRes.message)\r\n            switch (checkRes.code) {\r\n                // 过期\r\n                case 800:\r\n                    setTipMsg('二维码过期，请点击重新加载')\r\n                    qrCode = 800\r\n                    clearInterval(timer)\r\n                    break;\r\n                // 等待扫码\r\n                case 801:\r\n                    break;\r\n                // 等待确认\r\n                case 802:\r\n                    break;\r\n                // 授权登录成功\r\n                case 803:\r\n                    setTipMsg('授权登录成功')\r\n                    clearInterval(timer)\r\n                    let useInfo = (await getStatus({ timerstamp: Date.now() })).data.data\r\n                    console.log(useInfo)\r\n                    setNetCloundId(useInfo.account.id)\r\n                    break;\r\n            }\r\n        }, 5000)\r\n\r\n    }\r\n//     anonimousUser: false\r\n// ban: 0\r\n// baoyueVersion: 0\r\n// createTime: 1489226473866\r\n// donateVersion: 0\r\n// id: 435984810\r\n// paidFee: false\r\n// status: 0\r\n// tokenVersion: 0\r\n// type: 5\r\n// userName: \"5_B1F6F86AF7AB70B58481DC3ED0C4180B\"\r\n// vipType: 0\r\n// whitelistAuthority: 0\r\n    function onClickQrImg() {\r\n        if (qrCode === 800) {\r\n            createQr()\r\n        }\r\n    }\r\n    useEffect(() => {\r\n        createQr()\r\n        return () => {\r\n            clearInterval(timer)\r\n        }\r\n    }, [])\r\n\r\n    return (\r\n        <div className=\"qrlogin-container\">\r\n            <h3>扫码登陆</h3>\r\n            <img onClick={() => { onClickQrImg() }} src={qrImg} />\r\n            <div >{tipMsg}</div>\r\n        </div>\r\n    )\r\n}","import React, { useState, useEffect, useCallback } from \"react\"\r\nimport { Modal, Card, Avatar, Table, PageHeader, message } from 'antd'\r\nimport {\r\n    useGetUserPlayList,\r\n    useGetPlayListDetail,\r\n    useGetSongDetail,\r\n    useGetSongUrl,\r\n    useGetSongLrc\r\n} from '@/App/httpClientRequest/netcloundApi';\r\nimport { getNetCloundId } from \"@/App/utils/operatorLocalStorage\";\r\nimport { CaretRightOutlined, VerticalAlignBottomOutlined } from '@ant-design/icons';\r\nimport './index.less'\r\nexport function NCPlayList(props) {\r\n    const { request: getUserPlayList } = useGetUserPlayList();\r\n\r\n    const { request: getSongDetail } = useGetSongDetail();\r\n    const [playList, setPlayList] = useState<any>([]);\r\n    const [curPlayList, setCurPlayList] = useState<any>(null)\r\n\r\n\r\n    useEffect(() => {\r\n\r\n        if (props.visiable) {\r\n            (\r\n                async () => {\r\n                    let res = (await getUserPlayList({ uid: getNetCloundId() })).data\r\n                    console.log(res)\r\n                    setPlayList(res.playlist)\r\n                }\r\n            )();\r\n        }\r\n\r\n        return () => {\r\n\r\n        }\r\n    }, [props.visiable])\r\n\r\n    return (\r\n        <Modal\r\n            title={`我的歌单`}\r\n            centered={true}\r\n            destroyOnClose={true}\r\n            visible={props.visiable}\r\n            cancelButtonProps={{ style: { display: 'none' } }}\r\n            okButtonProps={{ style: { display: 'none' } }}\r\n            width={750}\r\n            bodyStyle={{ minHeight: '400px', maxHeight: '600px', overflowY: 'scroll' }}\r\n            onCancel={() => { props.setVisiable() }}\r\n        >\r\n            {\r\n                curPlayList === null &&\r\n                <div className=\"play-list-container\">\r\n                    {\r\n                        playList.map(item => {\r\n                            return (\r\n                                <Card key={item.id}\r\n                                    hoverable\r\n                                    className=\"play-list-card\"\r\n                                    cover={<img onClick={() => { setCurPlayList(item.id) }} src={item.coverImgUrl} />}\r\n                                    actions={[\r\n                                        <div className=\"card-action-item\">标签：{item.tags}</div>,\r\n                                        <div className=\"card-action-item\">歌曲：{item.trackCount}</div>,\r\n                                        <div className=\"card-action-item\">播放：{item.playCount}</div>,\r\n                                    ]}\r\n                                >\r\n                                    <Card.Meta\r\n                                        avatar={<Avatar src={item.creator.avatarUrl} />}\r\n                                        title={item.name}\r\n                                        description={item.description}\r\n                                    />\r\n                                </Card>\r\n                            )\r\n                        })\r\n                    }\r\n                </div>\r\n            }\r\n\r\n            {\r\n                curPlayList !== null &&\r\n                <PlayListDetail {...props} curPlayListId={curPlayList} onBack={() => setCurPlayList(null)} />\r\n            }\r\n        </Modal>\r\n    )\r\n}\r\n\r\nfunction PlayListDetail(props) {\r\n    const columns = [\r\n        {\r\n            title: '音乐标题',\r\n            dataIndex: 'name',\r\n            key: 'name',\r\n        },\r\n        {\r\n            title: '歌手',\r\n            key: 'artist',\r\n            render: (item) => {\r\n                return (\r\n                    <div key={'artist'}>{item.ar[0].name}</div>\r\n                )\r\n            }\r\n        },\r\n        {\r\n            title: '专辑',\r\n            key: 'album',\r\n            render: (item) => {\r\n                return (\r\n                    <div key={'album'}>{item.al.name}</div>\r\n                )\r\n            }\r\n        },\r\n        {\r\n            // \r\n            title: '时长',\r\n            key: 'duration',\r\n            render: (item) => {\r\n                let min = parseInt((item.dt % 3600) / 60 + ''),\r\n                    sec = Math.ceil(item.dt % 60)\r\n                return (\r\n                    <div key={'duration'}>{min}:{sec}</div>\r\n                )\r\n            }\r\n        },\r\n        {\r\n            title: '操作',\r\n            key: 'action',\r\n            width: '80px',\r\n            render: (item) => {\r\n                return (\r\n                    <div key={'duration'}>\r\n                        <CaretRightOutlined onClick={() => onClickPlay(item.id)} />\r\n                        <VerticalAlignBottomOutlined onClick={() => onClickDownload(item.id)} />\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    ];\r\n\r\n    const { request: getSongDetail } = useGetSongDetail()\r\n    const { request: getPlayListDetail } = useGetPlayListDetail();\r\n    const { request: getSongUrl } = useGetSongUrl()\r\n    const { request: getSongLrc } = useGetSongLrc()\r\n    const [playListDetail, setPlayListDetail] = useState<any>(null)\r\n    async function getUrl(id: string) {\r\n\r\n        let res = (await getSongUrl({ id })).data.data\r\n        console.log(res)\r\n        return res[0].url\r\n    }\r\n    async function getLrc(id: string) {\r\n        let res = (await getSongLrc({ id })).data\r\n        console.log(res)\r\n        return res.lrc.lyric;\r\n    }\r\n    async function getAudio(id) {\r\n        let song = (await getSongDetail({ ids: id })).data.songs[0]\r\n        return {\r\n            name: song.name,\r\n            artist: song.ar[0].name,\r\n            url: '',\r\n            cover: song.al.picUrl,\r\n            lrc: '',\r\n            theme: ''\r\n        }\r\n    }\r\n    async function onClickPlay(id) {\r\n        let audio = await getAudio(id)\r\n        audio.url = await getUrl(id)\r\n        audio.lrc = await getLrc(id)\r\n        props.player.list.add(audio);\r\n        console.log(audio)\r\n    }\r\n    async function onClickDownload(id) {\r\n\r\n    }\r\n\r\n    useEffect(() => {\r\n        (\r\n            async () => {\r\n                let res = (await getPlayListDetail({ id: props.curPlayListId })).data\r\n                setPlayListDetail(res)\r\n            }\r\n        )()\r\n\r\n    }, [props.curPlayListId])\r\n\r\n    return (\r\n        <div className=\"play-list-detail\">\r\n            <PageHeader\r\n                onBack={() => { props.onBack() }}\r\n                title={playListDetail?.playlist.name}\r\n                subTitle={playListDetail?.playlist.description}\r\n            />\r\n            {\r\n                playListDetail !== null &&\r\n                <Table rowKey='id' columns={columns} dataSource={playListDetail.playlist.tracks} />\r\n            }\r\n        </div>\r\n    )\r\n}\r\n\r\n","import { useRequest } from './http';\r\n\r\nimport { MiGuMusicIP } from \"@/common/constant\";\r\n\r\n/**\r\n * api文档地址 https://jsososo.github.io/MiguMusicApi/#/?id=node-%e6%9c%8d%e5%8a%a1\r\n */\r\n\r\n/**\r\n * 接口：搜索\r\n * 参数：\r\n * keyword: 搜索关键词 必填\r\n\r\n * type: 默认 song，支持：song, playlist, mv, singer, album, lyric\r\n\r\n * 0：单曲，2：歌单，7：歌词，8：专辑，9：歌手，12：mv\r\n * pageNo: 默认 1\r\n */\r\n export const useMgGetSearch = () => useRequest(`${MiGuMusicIP}/search`, { method: 'get' });\r\n\r\n /**\r\n  * 接口: 获取单个歌曲信息，包含url 和 lrc\r\n  * 参数：\r\n  *  cid ：歌曲id\r\n  */\r\n export const useMgGetSongInfo = () => useRequest(`${MiGuMusicIP}/song`, { method: 'get' });\r\n \r\n /**\r\n  * 接口: 获取单个歌曲歌词\r\n  * 参数：\r\n  *  cid ：歌曲id\r\n  */\r\n  export const useMgGetSongLrc = () => useRequest(`${MiGuMusicIP}/lyric`, { method: 'get' });","import { useRequest } from './http';\r\n\r\nimport { QQMusicIP } from \"@/common/constant\";\r\n/**\r\n * api文档地址 https://qq-api-soso.vercel.app/#/?id=%e6%90%9c%e7%b4%a2-1\r\n */\r\n\r\n/**\r\n * 接口：搜索\r\n * 参数：\r\n * key: 关键词 必填\r\n\r\n * pageNo: 页码，默认 1\r\n\r\n * pageSize: 一页返回数量，默认 20\r\n\r\n * t: 搜索类型 默认为 0 // 0：单曲，2：歌单，7：歌词，8：专辑，9：歌手，12：mv\r\n * 示例：/search?key=周杰伦\r\n */\r\nexport const useQQGetSearch = () => useRequest(`${QQMusicIP}/search`, { method: 'get' });\r\n\r\n/**\r\n * 接口: 获取单个歌曲信息，不包含歌词\r\n * 参数：\r\n *  songmid ：歌曲id\r\n */\r\nexport const useQQGetSongInfo = () => useRequest(`${QQMusicIP}//song/url`, { method: 'get' });\r\n\r\n/**\r\n * 接口: 获取单个歌曲歌词\r\n * 参数：\r\n *  songmid ：歌曲id\r\n */\r\n export const useQQGetSongLrc = () => useRequest(`${QQMusicIP}/lyric`, { method: 'get' });\r\n\r\n","import React, { useImperativeHandle } from 'react'\r\nimport {\r\n    useGetSongUrl,\r\n    useGetSongLrc,\r\n    useGetCloundSearch\r\n\r\n} from '@/App/httpClientRequest/netcloundApi';\r\nimport { useMgGetSearch, useMgGetSongInfo, useMgGetSongLrc } from \"@/App/httpClientRequest/miguMusicApi\";\r\nimport { useQQGetSearch, useQQGetSongInfo, useQQGetSongLrc } from \"@/App/httpClientRequest/qqMusicApi\";\r\ninterface Song {\r\n    id: String,\r\n    name: String,\r\n    albumname: String,\r\n    artist: String,\r\n    cover: String\r\n}\r\n\r\nexport const SongTool = React.forwardRef((props, ref) => {\r\n    const { request: getNcSearch } = useGetCloundSearch();\r\n    const { request: getMgSearch } = useMgGetSearch();\r\n    const { request: getQQSearch } = useQQGetSearch();\r\n\r\n    const { request: getNcUrl } = useGetSongUrl();\r\n    const { request: getMgUrl } = useMgGetSongInfo();\r\n    const { request: getQQUrl } = useQQGetSongInfo();\r\n\r\n    const { request: getNcLrc } = useGetSongLrc();\r\n    const { request: getMgLrc } = useMgGetSongLrc();\r\n    const { request: getQQLrc } = useQQGetSongLrc();\r\n\r\n    async function SearchSong(type: string, value: string): Promise<Array<Song>> {\r\n        let songList: Array<Song> = [], res: any, song: any = {};\r\n        switch (type) {\r\n            case '1':\r\n                res = (await getNcSearch({ keywords: value })).data.result;\r\n                if (res !== {}) {\r\n                    res.songs.forEach(item => {\r\n                        song.albumname = item.al.name;\r\n                        song.artist = item.ar[0].name;\r\n                        song.id = item.id;\r\n                        song.name = item.name;\r\n                        song.cover = item.al.picUrl;\r\n                        songList.push(song);\r\n                        song = {};\r\n                    });\r\n                }\r\n                break;\r\n            case '2':\r\n                res = (await getMgSearch({ keyword: value })).data.data;\r\n                res.list.forEach(item => {\r\n                    song.albumname = item.album.name;\r\n                    song.artist = item.artists[0].name;\r\n                    song.id = item.id;\r\n                    song.name = item.name;\r\n                    song.cover = item.album.picUrl;\r\n                    songList.push(song);\r\n                    song = {};\r\n                });\r\n                break;\r\n            case '3':\r\n                res = (await getQQSearch({ key: value })).data.data;\r\n                res.list.forEach(item => {\r\n                    song.albumname = item.albumname;\r\n                    song.artist = item.singer[0].name;\r\n                    song.id = item.songmid;\r\n                    song.name = item.songname;\r\n                    song.cover = ''\r\n                    songList.push(song);\r\n                    song = {};\r\n                });\r\n                break;\r\n        }\r\n        return songList\r\n    }\r\n    async function SongUrl(type: string, value: string): Promise<string> {\r\n        let url: string = ''\r\n        switch (type) {\r\n            case '1':\r\n                url = (await getNcUrl({ id: Number(value) })).data.data[0].url;\r\n                break;\r\n            case '2':\r\n                url = (await getMgUrl({ cid: value })).data.data['320'];\r\n                break;\r\n            case '3':\r\n                url = (await getQQUrl({ id: value })).data.data\r\n                break;\r\n        }\r\n        return url\r\n    }\r\n    async function SongLrc(type: string, value: string): Promise<string> {\r\n        let lrc: string = ''\r\n        switch (type) {\r\n            case '1':\r\n                lrc = (await getNcLrc({ id: Number(value) })).data.data.lrc.lyuic;\r\n                break;\r\n            case '2':\r\n                lrc = (await getMgUrl({ cid: value })).data.data.lyric;\r\n                break;\r\n            case '3':\r\n                lrc = (await getQQLrc({ songmid: value })).data.data.lyric;\r\n                break;\r\n        }\r\n        return lrc\r\n    }\r\n    useImperativeHandle(ref, () => ({\r\n        SearchSong,\r\n        SongUrl,\r\n        SongLrc,\r\n    }))\r\n    return null\r\n})","import React, { useState, useEffect, useCallback } from \"react\"\r\nimport { Modal, List, Avatar, Button, Table, Input, message, Tabs } from 'antd'\r\nimport {\r\n    useGetSongList,\r\n    useGetSongUrl,\r\n    useGetSongLrc,\r\n    useGetCloundSearch,\r\n    useGetSongDetail,\r\n\r\n} from '@/App/httpClientRequest/netcloundApi';\r\nimport { useMgGetSearch } from \"@/App/httpClientRequest/miguMusicApi\";\r\nimport { useQQGetSearch } from \"@/App/httpClientRequest/qqMusicApi\";\r\nimport { useSaveAudio } from \"@/App/httpClientRequest/audioApi\";\r\nimport { CaretRightOutlined, VerticalAlignBottomOutlined } from '@ant-design/icons';\r\nimport { getNetCloundId } from \"@/App/utils/operatorLocalStorage\";\r\nimport { useGlobalStore } from \"@/App/store/GlobalStore\";\r\nimport { SongTool } from \"../SongTool\";\r\nimport './index.less'\r\nexport function NCSongList(props) {\r\n\r\n    return (\r\n        <Modal\r\n            title={props.child === 'daily' ? '每日推荐' : `歌曲搜索`}\r\n            centered={true}\r\n            destroyOnClose={true}\r\n            visible={props.visiable}\r\n            cancelButtonProps={{ style: { display: 'none' } }}\r\n            okButtonProps={{ style: { display: 'none' } }}\r\n            width={800}\r\n            bodyStyle={{ minHeight: '400px', maxHeight: '600px', overflowY: 'scroll' }}\r\n            onCancel={() => { props.setVisiable() }}\r\n        >\r\n            {\r\n                props.child === 'daily' &&\r\n                <DailySong player={props.player} />\r\n            }\r\n            {\r\n                props.child === 'search' &&\r\n                <SearchSong player={props.player} />\r\n            }\r\n\r\n        </Modal>\r\n    )\r\n}\r\n\r\nfunction DailySong(props) {\r\n    const [list, setList] = useState<any>([])\r\n    const { request: getSongList } = useGetSongList()\r\n    const { request: getSongUrl } = useGetSongUrl()\r\n    const { request: getSongLrc } = useGetSongLrc()\r\n\r\n\r\n    useEffect(() => {\r\n        (\r\n            async () => {\r\n                let res = (await getSongList({ uid: getNetCloundId(), timerstamp: Date.now() })).data.data\r\n                console.log(res)\r\n                if (res.code === 301) {\r\n                    message.warn('需要重新扫码登录')\r\n                } else {\r\n                    setList(res.dailySongs)\r\n                }\r\n            }\r\n        )()\r\n\r\n        return () => {\r\n\r\n        }\r\n    }, [])\r\n\r\n    function createAudio(song) {\r\n        return {\r\n            name: song.name,\r\n            artist: song.ar[0].name,\r\n            url: '',\r\n            cover: song.al.picUrl,\r\n            lrc: '',\r\n            theme: ''\r\n        }\r\n    }\r\n    async function getUrl(id: string) {\r\n\r\n        let res = (await getSongUrl({ id: id })).data.data\r\n        console.log(res)\r\n        return res[0].url\r\n    }\r\n    async function getLrc(id: string) {\r\n        let res = (await getSongLrc({ id: id })).data\r\n        console.log(res)\r\n        return res.lrc.lyric;\r\n    }\r\n    async function onClickPlay(song) {\r\n        onClickAddList(song)\r\n        setTimeout(() => {\r\n            let index = props.player.list.audios.length - 1;\r\n            console.log(props.player.list.audios, index)\r\n            props.player.list.switch(index)\r\n            props.player.play()\r\n        }, 1000)\r\n    }\r\n    async function onClickAddList(song) {\r\n        console.log(props)\r\n        let url = await getUrl(song.id),\r\n            lrc = await getLrc(song.id),\r\n            audio = createAudio(song);\r\n        audio.url = url;\r\n        audio.lrc = lrc;\r\n        props.player.list.add(audio);\r\n    }\r\n    return (\r\n        <List\r\n            className=\"daily-song\"\r\n            itemLayout=\"horizontal\"\r\n            dataSource={list}\r\n            header={\r\n                <div className=\"daily-song-header\">\r\n                    <div className=\"header-name\">音乐标题</div>\r\n                    <div className=\"header-artist\">歌手</div>\r\n                    <div className=\"header-action\">操作</div>\r\n                </div>\r\n            }\r\n            renderItem={(item: any) => {\r\n                return (\r\n                    <List.Item>\r\n                        <List.Item.Meta\r\n                            avatar={<Avatar src={item.al.picUrl} />}\r\n                            title={\r\n                                <div className=\"song-title-bar\">\r\n                                    <div className=\"song-name\">{item.name}</div>\r\n                                    <div className=\"song-artist\">{item.ar[0].name}</div>\r\n                                    <div className=\"song-action-right\">\r\n                                        <Button onClick={() => { onClickPlay(item) }}>播放</Button>\r\n                                        <Button onClick={() => { onClickAddList(item) }}>加入列表</Button>\r\n                                    </div>\r\n                                </div>\r\n                            }\r\n                        />\r\n                    </List.Item>\r\n                )\r\n            }}\r\n        />\r\n    )\r\n}\r\n\r\nfunction SearchSong(props) {\r\n    const { request: getCloundSearch } = useGetCloundSearch();\r\n    const { request: getQQSerach } = useQQGetSearch();\r\n    const { request: getMgSearch } = useMgGetSearch();\r\n    const { request: getSongUrl } = useGetSongUrl();\r\n    const { request: getSongLrc } = useGetSongLrc();\r\n    const { request: getSongDetail } = useGetSongDetail();\r\n    const { request: saveAudio } = useSaveAudio();\r\n    const globalStore = useGlobalStore();\r\n    const [holderText, setHolderText] = useState(\"在网易云搜索\");\r\n    const [searchKey, setSearchKey] = useState('1');\r\n    const SongToolRef = React.createRef<any>()\r\n    const columns = [\r\n        {\r\n            title: '音乐标题',\r\n            dataIndex: 'name',\r\n            key: 'name',\r\n        },\r\n        {\r\n            title: '歌手',\r\n            key: 'artist',\r\n            dataIndex: 'artist',\r\n        },\r\n        {\r\n            title: '专辑',\r\n            key: 'albumname',\r\n            dataIndex: 'albumname',\r\n        },\r\n        // {\r\n        //     // \r\n        //     title: '时长',\r\n        //     key: 'duration',\r\n        //     render: (item) => {\r\n        //         let min = parseInt((item.dt % 3600) / 60 + ''),\r\n        //             sec = Math.ceil(item.dt % 60)\r\n        //         return (\r\n        //             <div key={'duration'}>{min}:{sec}</div>\r\n        //         )\r\n        //     }\r\n        // },\r\n        {\r\n            title: '操作',\r\n            key: 'action',\r\n            width:'100px',\r\n            render: (item) => {\r\n                return (\r\n                    <div key={'duration'}>\r\n                        <CaretRightOutlined onClick={() => onClickPlay(item)} />\r\n                        <VerticalAlignBottomOutlined onClick={() => onClickDownload(item.id)} />\r\n                    </div>\r\n                )\r\n            }\r\n        }\r\n    ];\r\n\r\n    const [songList, setSongList] = useState([])\r\n    async function onSearch(value) {\r\n        let songList = await SongToolRef.current.SearchSong(searchKey, value)\r\n\r\n        // console.log(songList)\r\n        setSongList(songList)\r\n    }\r\n    async function onClickPlay(item) {\r\n        let url = await SongToolRef.current.SongUrl(searchKey, item.id);\r\n        let lrc = await SongToolRef.current.SongLrc(searchKey, item.id);\r\n        item.url = url;\r\n        item.lrc = lrc;\r\n        props.player.list.add(item);\r\n    }\r\n    async function onClickDownload(id) {\r\n        // let audio = await getAudio(id)\r\n        // audio.url = await getUrl(id)\r\n        // audio.lrc = await getLrc(id)\r\n        // let res = (await saveAudio({ audio })).data.data;\r\n        // console.log(res)\r\n        message.info(\"小哥正在努力加班开发😷😷~~~\")\r\n    }\r\n    function onTabChange(key: string) {\r\n        let text = ''\r\n        switch (key) {\r\n            case '1':\r\n                text = '在网易云搜索';\r\n                break;\r\n            case '2':\r\n                text = '在咪咕音乐搜索';\r\n                break;\r\n            case '3':\r\n                //text = '在QQ音乐搜索';\r\n                message.info(\"暂不支持老马🤪🤪~~~\")\r\n                return;\r\n        }\r\n        setHolderText(text);\r\n        setSearchKey(key);\r\n    }\r\n    return (\r\n        <div >\r\n            <SongTool ref={SongToolRef} />\r\n            <Tabs onChange={onTabChange} defaultActiveKey=\"1\" type=\"card\" size={\"middle\"}>\r\n                <Tabs.TabPane tab=\"网易云\" key=\"1\" />\r\n                <Tabs.TabPane tab=\"咪咕音乐\" key=\"2\" />\r\n                <Tabs.TabPane tab=\"QQ音乐\" key=\"3\" />\r\n            </Tabs>\r\n            <Input.Search placeholder={holderText} onSearch={onSearch} enterButton />\r\n            <Table rowKey='id' columns={columns} dataSource={songList} />\r\n\r\n        </div>\r\n    )\r\n}","import { useRequest } from './http';\r\n\r\nimport { apiIp } from \"@/common/constant\";\r\n/*\r\n* 保存一个音频\r\n* @param {Object} audio 音频对象\r\n* @requestMethod POST\r\n* */\r\nexport const useSaveAudio = () => useRequest(`${apiIp}/api/audio/save`, { method: 'post' });\r\n\r\n/**\r\n * 获取所有音频列表\r\n */\r\nexport const useGetAudioList = () => useRequest(`${apiIp}/api/audio/list`, { method: 'get' });","import { rejects } from \"assert\"\r\n\r\n/*\r\n  CanvasImage Class\r\n  Class that wraps the html image element and canvas.\r\n  It also simplifies some of the canvas context manipulation\r\n  with a set of helper functions.\r\n*/\r\nclass CanvasImage {\r\n    constructor(image) {\r\n        this.canvas = document.createElement('canvas')\r\n        this.context = this.canvas.getContext('2d')\r\n\r\n        document.body.appendChild(this.canvas)\r\n\r\n        this.width = this.canvas.width = image.width\r\n        this.height = this.canvas.height = image.height\r\n\r\n        this.context.drawImage(image, 0, 0, this.width, this.height)\r\n    }\r\n\r\n    clear() {\r\n        this.context.clearRect(0, 0, this.width, this.height)\r\n    }\r\n\r\n    update(imageData) {\r\n        this.context.putImageData(imageData, 0, 0)\r\n    }\r\n\r\n    getPixelCount() {\r\n        return this.width * this.height\r\n    }\r\n\r\n    getImageData() {\r\n        return this.context.getImageData(0, 0, this.width, this.height)\r\n    }\r\n\r\n    removeCanvas = function () {\r\n        this.canvas.parentNode.removeChild(this.canvas)\r\n    }\r\n}\r\n\r\nexport default class ColorThief {\r\n\r\n    convertColorRgb(values) {\r\n        if (!values.length) return values\r\n\r\n        if (!values[0].length) return `rgb(${values[0]}, ${values[1]}, ${values[2]})`\r\n\r\n        return values.reduce(function (result, value) {\r\n            if (!value.length) return result\r\n\r\n            result.push(`rgb(${value[0]}, ${value[1]}, ${value[2]})`)\r\n            return result\r\n        }, [])\r\n    }\r\n\r\n    //TODO convertColorHex\r\n\r\n    /*\r\n    * getColor(sourceImage[, quality])\r\n    * returns [r(num), g(num), b(num)]\r\n    *\r\n    * Use the median cut algorithm provided by quantize.js to cluster similar\r\n    * colors and return the base color from the largest cluster.\r\n    *\r\n    * Quality is an optional argument. It needs to be an integer. 1 is the highest quality settings.\r\n    * 10 is the default. There is a trade-off between quality and speed. The bigger the number, the\r\n    * faster a color will be returned but the greater the likelihood that it will not be the visually\r\n    * most dominant color.\r\n    * */\r\n    getColor(sourceImage, quality) {\r\n        var palette = this.getPalette(sourceImage, 5, quality)\r\n        var dominantColor = palette[0]\r\n        return dominantColor\r\n    }\r\n\r\n    /*\r\n    * getPalette(sourceImage[, colorCount, quality])\r\n    * returns array[ [r(num), g(num), b(num)], [r(num), g(num), b(num)], ...]\r\n    *\r\n    * Use the median cut algorithm provided by quantize.js to cluster similar colors.\r\n    *\r\n    * colorCount determines the size of the palette; the number of colors returned. If not set, it\r\n    * defaults to 10.\r\n    *\r\n    * BUGGY: Function does not always return the requested amount of colors. It can be +/- 2.\r\n    *\r\n    * quality is an optional argument. It needs to be an integer. 1 is the highest quality settings.\r\n    * 10 is the default. There is a trade-off between quality and speed. The bigger the number, the\r\n    * faster the palette generation but the greater the likelihood that colors will be missed.\r\n    */\r\n    getPalette(sourceImage, colorCount, quality) {\r\n        if (typeof colorCount === 'undefined' || colorCount < 2 || colorCount > 256) {\r\n            colorCount = 10\r\n        }\r\n        if (typeof quality === 'undefined' || quality < 1) {\r\n            quality = 10\r\n        }\r\n\r\n        // Create custom CanvasImage object\r\n        const image = new CanvasImage(sourceImage)\r\n        const imageData = image.getImageData()\r\n        const pixels = imageData.data\r\n        const pixelCount = image.getPixelCount()\r\n\r\n        // Store the RGB values in an array format suitable for quantize function\r\n        const pixelArray = []\r\n        for (let i = 0, offset, r, g, b, a; i < pixelCount; i = i + quality) {\r\n            offset = i * 4\r\n            r = pixels[offset + 0]\r\n            g = pixels[offset + 1]\r\n            b = pixels[offset + 2]\r\n            a = pixels[offset + 3]\r\n            // If pixel is mostly opaque and not white\r\n            if (a >= 125) {\r\n                if (!(r > 250 && g > 250 && b > 250)) {\r\n                    pixelArray.push([r, g, b])\r\n                }\r\n            }\r\n        }\r\n\r\n        // Send array to quantize function which clusters values\r\n        // using median cut algorithm\r\n        const cmap = MMCQ.quantize(pixelArray, colorCount)\r\n        const palette = cmap ? cmap.palette() : []\r\n\r\n        // Clean up\r\n        image.removeCanvas()\r\n\r\n        return palette\r\n    }\r\n\r\n    getColorFromUrl(imageUrl, quality) {\r\n        \r\n\r\n        return new Promise(function (resolve,reject) {\r\n            if(!imageUrl || imageUrl.length === 0){\r\n                return reject('imgurl is not defind')\r\n            }\r\n            const sourceImage = document.createElement(\"img\")\r\n            const thief = this\r\n            sourceImage.addEventListener('load', function () {\r\n                const palette = thief.getPalette(sourceImage, 5, quality)\r\n                const dominantColor = palette[0]\r\n                resolve(dominantColor)\r\n            })\r\n            sourceImage.src = imageUrl\r\n        })\r\n    }\r\n\r\n    getImageData(imageUrl) {\r\n        return new Promise(function (resolve) {\r\n            const xhr = new XMLHttpRequest()\r\n            xhr.open('GET', imageUrl, true)\r\n            xhr.responseType = 'arraybuffer'\r\n            xhr.onload = function (e) {\r\n                if (this.status == 200) {\r\n                    const uInt8Array = new Uint8Array(this.response)\r\n                    const i = uInt8Array.length\r\n                    const binaryString = new Array(i)\r\n                    for (let i = 0; i < uInt8Array.length; i++) {\r\n                        binaryString[i] = String.fromCharCode(uInt8Array[i])\r\n                    }\r\n                    const data = binaryString.join('')\r\n                    const base64 = window.btoa(data)\r\n                    resolve(\"data:image/png;base64,\" + base64)\r\n                }\r\n            }\r\n            xhr.send()\r\n        })\r\n    }\r\n\r\n    getColorAsync(imageUrl, quality) {\r\n        const thief = this\r\n        return this.getImageData(imageUrl).then(function (imageData) {\r\n            return thief.getColorFromUrl(imageData, quality)\r\n        })\r\n    }\r\n}\r\n\r\n/*!\r\n* quantize.js Copyright 2008 Nick Rabinowitz.\r\n* Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php\r\n* @license\r\n*/\r\n\r\n// fill out a couple protovis dependencies\r\n/*!\r\n* Block below copied from Protovis: http://mbostock.github.com/protovis/\r\n* Copyright 2010 Stanford Visualization Group\r\n* Licensed under the BSD License: http://www.opensource.org/licenses/bsd-license.php\r\n* @license\r\n*/\r\nif (!pv) {\r\n    var pv = {\r\n        map: function (array, f) {\r\n            var o = {};\r\n            return f ? array.map(function (d, i) { o.index = i; return f.call(o, d); }) : array.slice();\r\n        },\r\n        naturalOrder: function (a, b) {\r\n            return (a < b) ? -1 : ((a > b) ? 1 : 0);\r\n        },\r\n        sum: function (array, f) {\r\n            var o = {};\r\n            return array.reduce(f ? function (p, d, i) { o.index = i; return p + f.call(o, d); } : function (p, d) { return p + d; }, 0);\r\n        },\r\n        max: function (array, f) {\r\n            return Math.max.apply(null, f ? pv.map(array, f) : array);\r\n        }\r\n    };\r\n}\r\n\r\n/**\r\n* Basic Javascript port of the MMCQ (modified median cut quantization)\r\n* algorithm from the Leptonica library (http://www.leptonica.com/).\r\n* Returns a color map you can use to map original pixels to the reduced\r\n* palette. Still a work in progress.\r\n*\r\n* @author Nick Rabinowitz\r\n* @example\r\n// array of pixels as [R,G,B] arrays\r\nvar myPixels = [[190,197,190], [202,204,200], [207,214,210], [211,214,211], [205,207,207]\r\n              // etc\r\n              ];\r\nvar maxColors = 4;\r\nvar cmap = MMCQ.quantize(myPixels, maxColors);\r\nvar newPalette = cmap.palette();\r\nvar newPixels = myPixels.map(function(p) {\r\n  return cmap.map(p);\r\n});\r\n*/\r\nvar MMCQ = (function () {\r\n    // private constants\r\n    var sigbits = 5,\r\n        rshift = 8 - sigbits,\r\n        maxIterations = 1000,\r\n        fractByPopulations = 0.75;\r\n\r\n    // get reduced-space color index for a pixel\r\n    function getColorIndex(r, g, b) {\r\n        return (r << (2 * sigbits)) + (g << sigbits) + b;\r\n    }\r\n\r\n    // Simple priority queue\r\n    function PQueue(comparator) {\r\n        var contents = [],\r\n            sorted = false;\r\n\r\n        function sort() {\r\n            contents.sort(comparator);\r\n            sorted = true;\r\n        }\r\n\r\n        return {\r\n            push: function (o) {\r\n                contents.push(o);\r\n                sorted = false;\r\n            },\r\n            peek: function (index) {\r\n                if (!sorted) sort();\r\n                if (index === undefined) index = contents.length - 1;\r\n                return contents[index];\r\n            },\r\n            pop: function () {\r\n                if (!sorted) sort();\r\n                return contents.pop();\r\n            },\r\n            size: function () {\r\n                return contents.length;\r\n            },\r\n            map: function (f) {\r\n                return contents.map(f);\r\n            },\r\n            debug: function () {\r\n                if (!sorted) sort();\r\n                return contents;\r\n            }\r\n        };\r\n    }\r\n\r\n    // 3d color space box\r\n    function VBox(r1, r2, g1, g2, b1, b2, histo) {\r\n        var vbox = this;\r\n        vbox.r1 = r1;\r\n        vbox.r2 = r2;\r\n        vbox.g1 = g1;\r\n        vbox.g2 = g2;\r\n        vbox.b1 = b1;\r\n        vbox.b2 = b2;\r\n        vbox.histo = histo;\r\n    }\r\n    VBox.prototype = {\r\n        volume: function (force) {\r\n            var vbox = this;\r\n            if (!vbox._volume || force) {\r\n                vbox._volume = ((vbox.r2 - vbox.r1 + 1) * (vbox.g2 - vbox.g1 + 1) * (vbox.b2 - vbox.b1 + 1));\r\n            }\r\n            return vbox._volume;\r\n        },\r\n        count: function (force) {\r\n            var vbox = this,\r\n                histo = vbox.histo;\r\n            if (!vbox._count_set || force) {\r\n                var npix = 0,\r\n                    index, i, j, k;\r\n                for (i = vbox.r1; i <= vbox.r2; i++) {\r\n                    for (j = vbox.g1; j <= vbox.g2; j++) {\r\n                        for (k = vbox.b1; k <= vbox.b2; k++) {\r\n                            index = getColorIndex(i, j, k);\r\n                            npix += (histo[index] || 0);\r\n                        }\r\n                    }\r\n                }\r\n                vbox._count = npix;\r\n                vbox._count_set = true;\r\n            }\r\n            return vbox._count;\r\n        },\r\n        copy: function () {\r\n            var vbox = this;\r\n            return new VBox(vbox.r1, vbox.r2, vbox.g1, vbox.g2, vbox.b1, vbox.b2, vbox.histo);\r\n        },\r\n        avg: function (force) {\r\n            var vbox = this,\r\n                histo = vbox.histo;\r\n            if (!vbox._avg || force) {\r\n                var ntot = 0,\r\n                    mult = 1 << (8 - sigbits),\r\n                    rsum = 0,\r\n                    gsum = 0,\r\n                    bsum = 0,\r\n                    hval,\r\n                    i, j, k, histoindex;\r\n                for (i = vbox.r1; i <= vbox.r2; i++) {\r\n                    for (j = vbox.g1; j <= vbox.g2; j++) {\r\n                        for (k = vbox.b1; k <= vbox.b2; k++) {\r\n                            histoindex = getColorIndex(i, j, k);\r\n                            hval = histo[histoindex] || 0;\r\n                            ntot += hval;\r\n                            rsum += (hval * (i + 0.5) * mult);\r\n                            gsum += (hval * (j + 0.5) * mult);\r\n                            bsum += (hval * (k + 0.5) * mult);\r\n                        }\r\n                    }\r\n                }\r\n                if (ntot) {\r\n                    vbox._avg = [~~(rsum / ntot), ~~(gsum / ntot), ~~(bsum / ntot)];\r\n                } else {\r\n                    //                    console.log('empty box');\r\n                    vbox._avg = [\r\n                        ~~(mult * (vbox.r1 + vbox.r2 + 1) / 2),\r\n                        ~~(mult * (vbox.g1 + vbox.g2 + 1) / 2),\r\n                        ~~(mult * (vbox.b1 + vbox.b2 + 1) / 2)\r\n                    ];\r\n                }\r\n            }\r\n            return vbox._avg;\r\n        },\r\n        contains: function (pixel) {\r\n            var vbox = this,\r\n                rval = pixel[0] >> rshift,\r\n            gval = pixel[1] >> rshift,\r\n            bval = pixel[2] >> rshift;\r\n            return (rval >= vbox.r1 && rval <= vbox.r2 &&\r\n                gval >= vbox.g1 && gval <= vbox.g2 &&\r\n                bval >= vbox.b1 && bval <= vbox.b2);\r\n        }\r\n    };\r\n\r\n    // Color map\r\n    function CMap() {\r\n        this.vboxes = new PQueue(function (a, b) {\r\n            return pv.naturalOrder(\r\n                a.vbox.count() * a.vbox.volume(),\r\n                b.vbox.count() * b.vbox.volume()\r\n            );\r\n        });\r\n    }\r\n    CMap.prototype = {\r\n        push: function (vbox) {\r\n            this.vboxes.push({\r\n                vbox: vbox,\r\n                color: vbox.avg()\r\n            });\r\n        },\r\n        palette: function () {\r\n            return this.vboxes.map(function (vb) { return vb.color; });\r\n        },\r\n        size: function () {\r\n            return this.vboxes.size();\r\n        },\r\n        map: function (color) {\r\n            var vboxes = this.vboxes;\r\n            for (var i = 0; i < vboxes.size(); i++) {\r\n                if (vboxes.peek(i).vbox.contains(color)) {\r\n                    return vboxes.peek(i).color;\r\n                }\r\n            }\r\n            return this.nearest(color);\r\n        },\r\n        nearest: function (color) {\r\n            var vboxes = this.vboxes,\r\n                d1, d2, pColor;\r\n            for (var i = 0; i < vboxes.size(); i++) {\r\n                d2 = Math.sqrt(\r\n                    Math.pow(color[0] - vboxes.peek(i).color[0], 2) +\r\n                    Math.pow(color[1] - vboxes.peek(i).color[1], 2) +\r\n                    Math.pow(color[2] - vboxes.peek(i).color[2], 2)\r\n                );\r\n                if (d2 < d1 || d1 === undefined) {\r\n                    d1 = d2;\r\n                    pColor = vboxes.peek(i).color;\r\n                }\r\n            }\r\n            return pColor;\r\n        },\r\n        forcebw: function () {\r\n            // XXX: won't  work yet\r\n            var vboxes = this.vboxes;\r\n            vboxes.sort(function (a, b) { return pv.naturalOrder(pv.sum(a.color), pv.sum(b.color)); });\r\n\r\n            // force darkest color to black if everything < 5\r\n            var lowest = vboxes[0].color;\r\n            if (lowest[0] < 5 && lowest[1] < 5 && lowest[2] < 5)\r\n                vboxes[0].color = [0, 0, 0];\r\n\r\n            // force lightest color to white if everything > 251\r\n            var idx = vboxes.length - 1,\r\n                highest = vboxes[idx].color;\r\n            if (highest[0] > 251 && highest[1] > 251 && highest[2] > 251)\r\n                vboxes[idx].color = [255, 255, 255];\r\n        }\r\n    };\r\n\r\n    // histo (1-d array, giving the number of pixels in\r\n    // each quantized region of color space), or null on error\r\n    function getHisto(pixels) {\r\n        var histosize = 1 << (3 * sigbits),\r\n            histo = new Array(histosize),\r\n            index, rval, gval, bval;\r\n        pixels.forEach(function (pixel) {\r\n            rval = pixel[0] >> rshift;\r\n            gval = pixel[1] >> rshift;\r\n            bval = pixel[2] >> rshift;\r\n            index = getColorIndex(rval, gval, bval);\r\n            histo[index] = (histo[index] || 0) + 1;\r\n        });\r\n        return histo;\r\n    }\r\n\r\n    function vboxFromPixels(pixels, histo) {\r\n        var rmin = 1000000, rmax = 0,\r\n            gmin = 1000000, gmax = 0,\r\n            bmin = 1000000, bmax = 0,\r\n            rval, gval, bval;\r\n        // find min/max\r\n        pixels.forEach(function (pixel) {\r\n            rval = pixel[0] >> rshift;\r\n            gval = pixel[1] >> rshift;\r\n            bval = pixel[2] >> rshift;\r\n            if (rval < rmin) rmin = rval;\r\n            else if (rval > rmax) rmax = rval;\r\n            if (gval < gmin) gmin = gval;\r\n            else if (gval > gmax) gmax = gval;\r\n            if (bval < bmin) bmin = bval;\r\n            else if (bval > bmax) bmax = bval;\r\n        });\r\n        return new VBox(rmin, rmax, gmin, gmax, bmin, bmax, histo);\r\n    }\r\n\r\n    function medianCutApply(histo, vbox) {\r\n        if (!vbox.count()) return;\r\n\r\n        var rw = vbox.r2 - vbox.r1 + 1,\r\n            gw = vbox.g2 - vbox.g1 + 1,\r\n            bw = vbox.b2 - vbox.b1 + 1,\r\n            maxw = pv.max([rw, gw, bw]);\r\n        // only one pixel, no split\r\n        if (vbox.count() == 1) {\r\n            return [vbox.copy()];\r\n        }\r\n        /* Find the partial sum arrays along the selected axis. */\r\n        var total = 0,\r\n            partialsum = [],\r\n            lookaheadsum = [],\r\n            i, j, k, sum, index;\r\n        if (maxw == rw) {\r\n            for (i = vbox.r1; i <= vbox.r2; i++) {\r\n                sum = 0;\r\n                for (j = vbox.g1; j <= vbox.g2; j++) {\r\n                    for (k = vbox.b1; k <= vbox.b2; k++) {\r\n                        index = getColorIndex(i, j, k);\r\n                        sum += (histo[index] || 0);\r\n                    }\r\n                }\r\n                total += sum;\r\n                partialsum[i] = total;\r\n            }\r\n        }\r\n        else if (maxw == gw) {\r\n            for (i = vbox.g1; i <= vbox.g2; i++) {\r\n                sum = 0;\r\n                for (j = vbox.r1; j <= vbox.r2; j++) {\r\n                    for (k = vbox.b1; k <= vbox.b2; k++) {\r\n                        index = getColorIndex(j, i, k);\r\n                        sum += (histo[index] || 0);\r\n                    }\r\n                }\r\n                total += sum;\r\n                partialsum[i] = total;\r\n            }\r\n        }\r\n        else {  /* maxw == bw */\r\n            for (i = vbox.b1; i <= vbox.b2; i++) {\r\n                sum = 0;\r\n                for (j = vbox.r1; j <= vbox.r2; j++) {\r\n                    for (k = vbox.g1; k <= vbox.g2; k++) {\r\n                        index = getColorIndex(j, k, i);\r\n                        sum += (histo[index] || 0);\r\n                    }\r\n                }\r\n                total += sum;\r\n                partialsum[i] = total;\r\n            }\r\n        }\r\n        partialsum.forEach(function (d, i) {\r\n            lookaheadsum[i] = total - d;\r\n        });\r\n        function doCut(color) {\r\n            var dim1 = color + '1',\r\n                dim2 = color + '2',\r\n                left, right, vbox1, vbox2, d2, count2 = 0;\r\n            for (i = vbox[dim1]; i <= vbox[dim2]; i++) {\r\n                if (partialsum[i] > total / 2) {\r\n                    vbox1 = vbox.copy();\r\n                    vbox2 = vbox.copy();\r\n                    left = i - vbox[dim1];\r\n                    right = vbox[dim2] - i;\r\n                    if (left <= right)\r\n                        d2 = Math.min(vbox[dim2] - 1, ~~(i + right / 2));\r\n                    else d2 = Math.max(vbox[dim1], ~~(i - 1 - left / 2));\r\n                    // avoid 0-count boxes\r\n                    while (!partialsum[d2]) d2++;\r\n                    count2 = lookaheadsum[d2];\r\n                    while (!count2 && partialsum[d2 - 1]) count2 = lookaheadsum[--d2];\r\n                    // set dimensions\r\n                    vbox1[dim2] = d2;\r\n                    vbox2[dim1] = vbox1[dim2] + 1;\r\n                    //                    console.log('vbox counts:', vbox.count(), vbox1.count(), vbox2.count());\r\n                    return [vbox1, vbox2];\r\n                }\r\n            }\r\n\r\n        }\r\n        // determine the cut planes\r\n        return maxw == rw ? doCut('r') :\r\n            maxw == gw ? doCut('g') :\r\n                doCut('b');\r\n    }\r\n\r\n    function quantize(pixels, maxcolors) {\r\n        // short-circuit\r\n        if (!pixels.length || maxcolors < 2 || maxcolors > 256) {\r\n            //            console.log('wrong number of maxcolors');\r\n            return false;\r\n        }\r\n\r\n        // XXX: check color content and convert to grayscale if insufficient\r\n\r\n        var histo = getHisto(pixels),\r\n            histosize = 1 << (3 * sigbits);\r\n\r\n        // check that we aren't below maxcolors already\r\n        var nColors = 0;\r\n        histo.forEach(function () { nColors++; });\r\n        if (nColors <= maxcolors) {\r\n            // XXX: generate the new colors from the histo and return\r\n        }\r\n\r\n        // get the beginning vbox from the colors\r\n        var vbox = vboxFromPixels(pixels, histo),\r\n            pq = new PQueue(function (a, b) { return pv.naturalOrder(a.count(), b.count()); });\r\n        pq.push(vbox);\r\n\r\n        // inner function to do the iteration\r\n        function iter(lh, target) {\r\n            var ncolors = 1,\r\n                niters = 0,\r\n                vbox;\r\n            while (niters < maxIterations) {\r\n                vbox = lh.pop();\r\n                if (!vbox.count()) { /* just put it back */\r\n                    lh.push(vbox);\r\n                    niters++;\r\n                    continue;\r\n                }\r\n                // do the cut\r\n                var vboxes = medianCutApply(histo, vbox),\r\n                    vbox1 = vboxes[0],\r\n                    vbox2 = vboxes[1];\r\n\r\n                if (!vbox1) {\r\n                    //                    console.log(\"vbox1 not defined; shouldn't happen!\");\r\n                    return;\r\n                }\r\n                lh.push(vbox1);\r\n                if (vbox2) {  /* vbox2 can be null */\r\n                    lh.push(vbox2);\r\n                    ncolors++;\r\n                }\r\n                if (ncolors >= target) return;\r\n                if (niters++ > maxIterations) {\r\n                    //                    console.log(\"infinite loop; perhaps too few pixels!\");\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n\r\n        // first set of colors, sorted by population\r\n        iter(pq, fractByPopulations * maxcolors);\r\n\r\n        // Re-sort by the product of pixel occupancy times the size in color space.\r\n        var pq2 = new PQueue(function (a, b) {\r\n            return pv.naturalOrder(a.count() * a.volume(), b.count() * b.volume());\r\n        });\r\n        while (pq.size()) {\r\n            pq2.push(pq.pop());\r\n        }\r\n\r\n        // next set - generate the median cuts using the (npix * vol) sorting.\r\n        iter(pq2, maxcolors - pq2.size());\r\n\r\n        // calculate the actual colors\r\n        var cmap = new CMap();\r\n        while (pq2.size()) {\r\n            cmap.push(pq2.pop());\r\n        }\r\n\r\n        return cmap;\r\n    }\r\n\r\n    return {\r\n        quantize: quantize\r\n    };\r\n})();","import React, { useEffect, useState } from 'react';\r\nimport APlayer from 'aplayer'\r\nimport { useGetMusic } from \"@/App/httpClientRequest/useApi\";\r\nimport { useGetAudioList } from '@/App/httpClientRequest/audioApi';\r\nimport { NCLogin } from '@/App/pages/NetClound/NCLogin'\r\nimport { NCPlayList } from '@/App/pages/NetClound/NCPlayList'\r\nimport { NCSongList } from '@/App/pages/NetClound/NCSongList'\r\nimport { getNetCloundId } from \"@/App/utils/operatorLocalStorage\";\r\nimport './index.less'\r\nimport { Button, message } from 'antd';\r\nimport ColorThief from './color-thief'\r\nexport function ChatPlayer() {\r\n    const option = {\r\n        mini: false,\r\n        autoplay: false,\r\n        theme: '#90EE90',\r\n        loop: 'all',\r\n        preload: 'auto',\r\n        volume: 0.7,\r\n        mutex: true,\r\n        listFolded: false,\r\n        listMaxHeight: '100px',\r\n        lrcType: 1, // 1：js字符串；3：lrc文件\r\n    }\r\n    const { request: getMusic } = useGetMusic()\r\n    const { request: getAudioList } = useGetAudioList()\r\n    const [ncLogin, setNclogin] = useState(false)\r\n    const [ncPlayList, setNcPlayList] = useState(false)\r\n    const [ncSongList, setNcSongList] = useState(false)\r\n    const [songListChild, setSongListChild] = useState(\"\")\r\n    const [player, setPlayer] = useState<any>(null)\r\n\r\n    function setTheme(ap, index) {\r\n        const colorThief = new ColorThief()\r\n\r\n        let img = process.env.NODE_ENV === 'development' ? '' : ap.list.audios[index].cover\r\n        colorThief.getColorFromUrl(img, 'hex').then(res => {\r\n            console.log(res)\r\n            ap.theme(res, index);\r\n        }).catch(err => {\r\n            console.log(err)\r\n        })\r\n    };\r\n\r\n    useEffect(() => {\r\n        const ap = new APlayer({ ...option, container: document.getElementById('player') });\r\n        ap.on(\"listswitch\", (e) => {\r\n            let { index } = e\r\n            // console.log(index, ap)\r\n            if (ap.list.audios[index].cover) {\r\n                setTheme(ap, index)\r\n            }\r\n        })\r\n        setPlayer(ap);\r\n        (\r\n            async () => {\r\n                let { musicList } = (await getMusic()).data.data;\r\n\r\n                let { audioList } = (await getAudioList()).data.data;\r\n                ap.list.add([...musicList, ...audioList])\r\n            }\r\n        )();\r\n\r\n    }, [])\r\n\r\n    return (\r\n        <div className=\"chat-player\">\r\n            <div className=\"net-clound-bar\" >\r\n                <Button onClick={() => { setNclogin(true) }}>登录</Button>\r\n                <Button onClick={() => {\r\n                    if (!getNetCloundId()) {\r\n                        message.info('请先进行登录')\r\n                        return\r\n                    }\r\n                    setNcPlayList(true)\r\n                }}>我的歌单</Button>\r\n                <Button onClick={() => {\r\n                    if (!getNetCloundId()) {\r\n                        message.info('请先进行登录')\r\n                        return\r\n                    }\r\n                    setNcSongList(true); setSongListChild('daily')\r\n                }}>日推歌曲</Button>\r\n                <Button onClick={() => { setNcSongList(true); setSongListChild('search') }}>搜索</Button>\r\n            </div >\r\n            <div id=\"player\"></div>\r\n\r\n            <NCLogin visiable={ncLogin} setVisiable={() => { setNclogin(false) }} />\r\n            <NCPlayList player={player} visiable={ncPlayList} setVisiable={() => { setNcPlayList(false) }} />\r\n            <NCSongList player={player} child={songListChild} visiable={ncSongList} setVisiable={() => { setNcSongList(false) }} />\r\n\r\n        </div >\r\n    )\r\n}","import React, { useEffect, useState, useRef } from 'react';\r\nimport { Button } from 'antd'\r\nimport './index.less';\r\n\r\nexport default function Tetris(props) {\r\n    const [grid, setGrid] = useState<any[]>([])\r\n    const [switchL, setSwitchL] = useState(true)\r\n    const [mode, setMode] = useState(\"normal\")\r\n    const [config, setConfig] = useState({\r\n        countX: 18,\r\n        countY: 9,\r\n        downTime: 1000,\r\n        boxSize: 50,\r\n        aWay: \"left\",\r\n        delayTime: 30,\r\n    })\r\n    const share = [\r\n        { s: [[-1, 0], [0, 0], [1, 0], [1, 1]], c: \"#f98866\", p: [1, 1], n: \"s1-1\" },\r\n        { s: [[1, 0], [1, 1], [1, 2], [0, 2]], c: \"#f98866\", p: [1, 1], n: \"s1-2\" },\r\n        { s: [[-1, 0], [-1, 1], [0, 1], [1, 1]], c: \"#f98866\", p: [1, 1], n: \"s1-3\" },\r\n        { s: [[0, 0], [0, 1], [0, 2], [1, 0]], c: \"#f98866\", p: [1, 1], n: \"s1-4\" },\r\n        { s: [[-1, 0], [0, 0], [1, 0], [-1, 1]], c: \"#ff420e\", p: [1, 1], n: \"s2-1\" },\r\n        { s: [[0, 0], [1, 0], [1, 1], [1, 2]], c: \"#ff420e\", p: [1, 1], n: \"s2-2\" },\r\n        { s: [[-1, 1], [0, 1], [1, 1], [1, 0]], c: \"#ff420e\", p: [1, 1], n: \"s2-3\" },\r\n        { s: [[0, 0], [0, 1], [0, 2], [1, 2]], c: \"#ff420e\", p: [1, 1], n: \"s2-4\" },\r\n        { s: [[0, 0], [1, 0], [0, 1], [1, 1]], c: \"#80bd9e\", p: [0, 0], n: \"s3-1\" },\r\n        { s: [[-1, 0], [0, 0], [1, 0], [2, 0]], c: \"#89da59\", p: [0, -2], n: \"s4-1\" },\r\n        { s: [[0, 0], [0, 1], [0, 2], [0, 3]], c: \"#89da59\", p: [1, -2], n: \"s4-2\" },\r\n        { s: [[0, 0], [-1, 1], [0, 1], [1, 1]], c: \"#90afc5\", p: [0, -1], n: \"s5-1\" },\r\n        { s: [[-1, 0], [-1, 1], [-1, 2], [0, 1]], c: \"#90afc5\", p: [1, -1], n: \"s5-2\" },\r\n        { s: [[-1, 0], [0, 0], [1, 0], [0, 1]], c: \"#90afc5\", p: [0, -1], n: \"s5-3\" },\r\n        { s: [[0, 0], [0, 1], [0, 2], [-1, 1]], c: \"#90afc5\", p: [0, -1], n: \"s5-4\" },\r\n        { s: [[-1, 0], [0, 0], [0, 1], [1, 1]], c: \"#336b87\", p: [0, -1], n: \"s6-1\" },\r\n        { s: [[0, 0], [0, 1], [-1, 1], [-1, 2]], c: \"#336b87\", p: [0, 0], n: \"s6-2\" },\r\n        { s: [[0, 0], [1, 0], [-1, 1], [0, 1]], c: \"#763626\", p: [0, 0], n: \"s7-1\" },\r\n        { s: [[-1, 0], [-1, 1], [0, 1], [0, 2]], c: \"#763626\", p: [0, 1], n: \"s7-2\" },\r\n        \r\n    ]\r\n    const scorres = useRef(0)\r\n    const cruActive = useRef({ s: ['4-1', '5-1', '6-1', '6-2'], c: \"#f98866\", n: \"s1-1\" })\r\n    const cruFinish = useRef([\r\n        { p: '1-19', s: \"static\" },\r\n        { p: '2-19', s: \"static\" },\r\n        { p: '3-19', s: \"static\" },\r\n        { p: '4-19', s: \"static\" },\r\n        { p: '5-19', s: \"static\" },\r\n        { p: '6-19', s: \"static\" },\r\n        { p: '7-19', s: \"static\" },\r\n        { p: '8-19', s: \"static\" },\r\n        { p: '9-19', s: \"static\" },\r\n    ])\r\n\r\n    const skewing = useRef(0)\r\n    const downIndex = useRef(0)\r\n    const canButton = useRef(true)\r\n\r\n    const getActiveGrid = (id) => {\r\n        let c = false\r\n        let d = cruActive.current.s.filter(e => e === id)\r\n        let f: any = cruFinish.current.filter(e => e.p === id)\r\n        let a = d.concat(f)\r\n        if (a.length > 0) {\r\n            c = true\r\n        }\r\n        return c\r\n    }\r\n\r\n    const getAcitveColor = (id) => {\r\n        let color = \"white\"\r\n        let d = cruActive.current.s.filter(e => e === id)\r\n        if (d.length > 0) {\r\n            color = cruActive.current.c\r\n        }\r\n        if (cruFinish.current.filter(e => e.p === id).length > 0) color = \"ping\"\r\n        return color\r\n    }\r\n\r\n    const gInit = () => {\r\n        let tGird: any[] = []\r\n        for (let j = 1; j < config.countX + 1; j++) {\r\n            for (let i = 1; i < config.countY + 1; i++) {\r\n                let ids = String(i) + \"-\" + String(j)\r\n                let g = {\r\n                    id: ids,\r\n                    show: getActiveGrid(ids),\r\n                    x: i,\r\n                    y: j,\r\n                    color: getAcitveColor(ids)\r\n                }\r\n                tGird.push(g)\r\n            }\r\n        }\r\n        setGrid(tGird)\r\n    }\r\n\r\n    const changeShare = () => {\r\n        let cruAn = cruActive.current.n\r\n        const b = share.filter(e => e.n === cruAn)[0].n\r\n        let a = b.split('-')[0]\r\n        let c = Number(b.split('-')[1])\r\n        let nb: string | number = ''\r\n        if (a === \"s3\") return\r\n        if (a === \"s1\" || a === \"s2\" || a === \"s5\") {\r\n            if (c === 4) {\r\n                nb = 1\r\n            } else {\r\n                nb = c + 1\r\n            }\r\n        }\r\n        if (a === \"s6\" || a === \"s7\" || a === \"s4\") {\r\n            if (c === 2) {\r\n                nb = 1\r\n            } else {\r\n                nb = c + 1\r\n            }\r\n        }\r\n        let z: any = share.filter(e => e.n === (a + \"-\" + String(nb)))[0]\r\n        let zs = z.s\r\n        let ns: string[] = []\r\n        zs.forEach(e => {\r\n            let ex = e[0] + 5 + skewing.current + ((a === \"s4\" || a === \"s5\" || a === \"s6\" || a === \"s7\") ? (skewing.current > 0 ? z.p[1] : z.p[0]) : 0)\r\n            let ey = e[1] + 1 + downIndex.current\r\n            ns.push(String(ex) + '-' + String(ey))\r\n        })\r\n        if (!checkCanChange(ns)) return\r\n        cruActive.current = { s: ns, c: z.c, n: a + \"-\" + String(nb) }\r\n        // share.current = z\r\n        gInit()\r\n    }\r\n\r\n    const checkCanChange = (ns) => {\r\n        let cb = true\r\n        cruFinish.current.forEach(e => {\r\n            if (ns.filter(e1 => e1 === e.p).length > 0) {\r\n                cb = false\r\n            }\r\n        })\r\n        return cb\r\n    }\r\n\r\n    const changeAway = (away) => {\r\n        if (checkAway(away)) return\r\n        let ca = { ...cruActive.current }\r\n        let cs = share.filter(e => e.n === ca.n)[0]\r\n        let py = away === 'right' ? 0 : cs.p[0]\r\n        let cas = ca.s.sort()\r\n        if ((Number(cas[away === 'right' ? cas.length - 1 : 0].split('-')[0])) === (away === 'right' ? config.countY : 1)) return\r\n        let ns: string[] = []\r\n        cas.forEach(e => {\r\n            let y = e.split(\"-\")[0]\r\n            let z = e.split(\"-\")[1]\r\n            ns.push(String(Number(y) + (away === 'right' ? 1 : -1)) + \"-\" + z)\r\n        })\r\n        if ((skewing.current) < 4 && away === 'right') {\r\n            skewing.current += 1\r\n        }\r\n        if ((skewing.current > -4 + py) && away === 'left') {\r\n            skewing.current -= 1\r\n        }\r\n        cruActive.current.s = ns\r\n        gInit()\r\n    }\r\n\r\n    const checkAway = (away) => {\r\n        let cb = false\r\n        let cas = { ...cruActive.current }\r\n        let newS: string[] = []\r\n        cas.s.forEach(e => {\r\n            let y = e.split(\"-\")[0]\r\n            let z = e.split(\"-\")[1]\r\n            newS.push(String(Number(y) + (away === 'right' ? 1 : -1)) + \"-\" + z)\r\n        })\r\n        newS.forEach(e => {\r\n            if (cruFinish.current.filter(e1 => e1.p === e).length !== 0) {\r\n                cb = true\r\n            }\r\n        })\r\n        return cb\r\n    }\r\n\r\n    const changeDown = () => {\r\n        if (oneGridFinish()) return\r\n        downIndex.current += 1\r\n        let ca = { ...cruActive.current }\r\n        let cas = ca.s.sort()\r\n        let ns: string[] = []\r\n        cas.forEach((e) => {\r\n            let y = e.split(\"-\")[0]\r\n            let z = e.split(\"-\")[1]\r\n            ns.push(y + \"-\" + String(Number(z) + 1))\r\n        })\r\n        cruActive.current.s = ns\r\n        gInit()\r\n    }\r\n\r\n    const oneGridFinish = () => {\r\n        let cb = false\r\n        let cas = { ...cruActive.current }\r\n        let newS: string[] = []\r\n        cas.s.forEach(e => {\r\n            let y = e.split(\"-\")[0]\r\n            let z = e.split(\"-\")[1]\r\n            newS.push(y + \"-\" + String(Number(z) + 1))\r\n        })\r\n        let ncas: any[] = []\r\n        newS.forEach(e => {\r\n            if (cruFinish.current.filter(e1 => e1.p === e).length !== 0 && !cb) {\r\n                // clearInterval(t)\r\n                cas.s.forEach((e1 => {\r\n                    let obj = {\r\n                        p: e1,\r\n                        s: \"none\",\r\n                        c: cas.c\r\n                    }\r\n                    ncas.push(obj)\r\n                }))\r\n                cb = true\r\n            }\r\n        })\r\n        if (cb) checkClear(ncas)\r\n        return cb\r\n    }\r\n\r\n    const checkClear = (ncas) => {\r\n        canButton.current = false\r\n        clearInterval(t)\r\n        cruFinish.current = cruFinish.current.concat(ncas)\r\n        cruActive.current = makeNew()\r\n        downIndex.current = 0\r\n        skewing.current = 0\r\n        let f: any[] = []\r\n        cruFinish.current.forEach(e => {\r\n            if (e.s !== \"static\") {\r\n                let x = Number(e.p.split('-')[0])\r\n                let y = Number(e.p.split('-')[1])\r\n                if (!f[y]) f[y] = []\r\n                f[y].push(e)\r\n            }\r\n        })\r\n        let xca: any[] = []\r\n        f.forEach(e => {\r\n            if (e.length === 9) {\r\n                xca.push(e)\r\n                e.forEach(e1 => {\r\n                    let index = cruFinish.current.findIndex(e => e1.p === e.p)\r\n                    cruFinish.current.splice(index, 1)\r\n                })\r\n            }\r\n        })\r\n        if (xca.length > 0) {\r\n            xca.forEach(e => {\r\n                let h1 = Number(e[0].p.split('-')[1])\r\n                cruFinish.current.forEach((e2, index) => {\r\n                    let y = Number(e2.p.split('-')[1])\r\n                    let x = e2.p.split('-')[0]\r\n                    if (e2.s !== \"static\" && (y < h1)) {\r\n                        e2.p = x + '-' + String(y + 1)\r\n                    }\r\n                })\r\n            })\r\n            console.log(\"xca.lengch\", xca.length, scorres)\r\n            let s = 0\r\n            switch (xca.length) {\r\n                case 1:\r\n                    scorres.current = scorres.current + 100\r\n                    break\r\n                case 2:\r\n                    scorres.current = scorres.current + 500\r\n                    break\r\n                case 3:\r\n                    scorres.current = scorres.current + 1000\r\n                    break\r\n                case 4:\r\n                    scorres.current = scorres.current + 5000\r\n                    break\r\n            }\r\n        }\r\n        t = setInterval(() => {\r\n            changeDown()\r\n        }, config.downTime)\r\n        canButton.current = true\r\n    }\r\n\r\n    const makeNew = () => {\r\n        let obj: any = { s: ['5-1', '4-2', '5-2', '6-2'], n: \"s5-1\" }\r\n        let ramIndex = Math.floor(Math.random() * share.length)\r\n        let zs = share[ramIndex]\r\n        let ns: string[] = []\r\n        zs.s.forEach(e => {\r\n            let ex = e[0] + 5\r\n            let ey = e[1] + 1\r\n            ns.push(String(ex) + '-' + String(ey))\r\n        })\r\n        obj = { s: ns, c: zs.c, n: zs.n }\r\n        return obj\r\n    }\r\n\r\n    const keydown = (e) => {\r\n        if (e.key === 'ArrowUp' && canButton.current) changeShare()\r\n        if (e.key === \"ArrowDown\" && canButton.current) changeDown()\r\n        if (e.key === \"ArrowLeft\" && canButton.current) changeAway('left')\r\n        if (e.key === \"ArrowRight\" && canButton.current) changeAway('right')\r\n    }\r\n\r\n    const rePlay = () => {\r\n        cruActive.current = { s: ['4-1', '5-1', '6-1', '6-2'], c: \"#f98866\", n: \"s1-1\" }\r\n        cruFinish.current = [\r\n            { p: '1-19', s: \"static\" },\r\n            { p: '2-19', s: \"static\" },\r\n            { p: '3-19', s: \"static\" },\r\n            { p: '4-19', s: \"static\" },\r\n            { p: '5-19', s: \"static\" },\r\n            { p: '6-19', s: \"static\" },\r\n            { p: '7-19', s: \"static\" },\r\n            { p: '8-19', s: \"static\" },\r\n            { p: '9-19', s: \"static\" },\r\n        ]\r\n        skewing.current = 0\r\n        downIndex.current = 0\r\n        canButton.current = true\r\n        scorres.current = 0\r\n        gInit()\r\n    }\r\n\r\n    let t: NodeJS.Timeout;\r\n    useEffect(() => {\r\n        gInit()\r\n        t = setInterval(() => {\r\n            changeDown()\r\n        }, config.downTime)\r\n        document.addEventListener(\"keydown\", keydown)\r\n    }, [])\r\n\r\n    return (\r\n        <div style={{ width: \"100%\", height: \"100%\", }} className=\"tow-box bg-orange\">\r\n            <div>\r\n                <div>分数：{scorres.current}</div>\r\n                <div><Button onClick={rePlay}>重來</Button></div>\r\n                <div>\r\n                    {grid.length > 0 &&\r\n                        <div className=\"one-contant\" style={{ width: (config.countY) * config.boxSize, height: (config.countX) * config.boxSize }}>\r\n                            {grid.map((g, index) => {\r\n                                // console.log(\"g...\", g.color)\r\n                                return (\r\n                                    <div className=\"tow-box\" key={index} style={{ backgroundColor: g.show ? g.color : \"white\", height: config.boxSize, width: config.boxSize }}>\r\n                                        {/* {g.id} */}\r\n                                    </div>\r\n                                )\r\n                            })}\r\n                        </div>\r\n                    }\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}","import React, { useState } from 'react';\r\nimport { Radio, Drawer } from 'antd';\r\nimport Tetris from \"@/App/layout/Chat/ChatGame/games/tetris\"\r\nimport './index.less';\r\n\r\nfunction CharGame() {\r\n    const gamesOption = [\r\n        { label: \"俄罗斯方块\", value: 'Tetris' },\r\n        { label: \"贪吃蛇\", value: 'Snake' },\r\n        { label: \"待定\", value: 'Wait' },\r\n    ]\r\n    const radioOnChange = (e) => {\r\n        const { value } = e.target\r\n        let obj = gamesOption.filter(e => e.value === value)\r\n        setRadioValue(obj[0]?.value)\r\n        setRadioLabel(obj[0]?.label)\r\n    }\r\n    const [radioValue, setRadioValue] = useState(\"\")\r\n    const [radioLabel, setRadioLabel] = useState(\"\")\r\n    const onClose = () => {\r\n        setRadioValue(\"\")\r\n    }\r\n    return (\r\n        <div>\r\n            <Radio.Group options={gamesOption} onChange={radioOnChange} value={radioValue} optionType=\"button\" />\r\n            <Drawer title={radioLabel} width={1500} placement=\"left\" onClose={onClose} visible={radioValue !== \"\"}>\r\n                <div style={{ width: \"100%\", height: \"100%\", background: \"rgba(0,0,0,0)\" }}>\r\n                    <Tetris radioValue={radioValue} />\r\n                </div>\r\n            </Drawer>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CharGame","/**\n * generateUUID 生成UUID\n * @returns {string} 返回字符串\n */\nfunction generateUUID() {\n  var d = new Date().getTime();\n  var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    var r = (d + Math.random() * 16) % 16 | 0;\n    d = Math.floor(d / 16);\n    return (c === 'x' ? r : (r & 0x7 | 0x8)).toString(16);\n  });\n  return uuid;\n}\n\nexport { generateUUID }","import React from 'react'\r\n\r\nconst globalContext = {\r\n    GlobalUser: React.createContext(null),\r\n}\r\n\r\nexport default globalContext","import React, { useEffect, useContext } from 'react';\nimport { Route, Switch } from 'react-router-dom';\nimport { Layout } from 'antd';\nimport './index.less';\nimport io from 'socket.io-client';\nimport { socketIp, sideWidth } from \"@/common/constant\";\nimport { Observer } from 'mobx-react-lite';\nimport routes from '@/App/router';\n\nimport WeChatHeader from \"@/App/layout/Chat/WeChatHeader\";\nimport SideUserList from \"@/App/layout/Chat/SideUserList\";\nimport { ChatPlayer } from \"@/App/layout/Chat/ChatPlayer\";\nimport ChatGame from \"@/App/layout/Chat/ChatGame\";\nimport { useGlobalStore } from \"@/App/store/GlobalStore\";\nimport { useChatStore } from \"@/App/layout/Chat/ChatStore/ChatStore\";\nimport { useMyInfo, useUserInfo } from \"@/App/httpClientRequest/useApi\";\nimport { generateUUID } from \"@/App/utils\";\nimport GlobalContext from '@/App/components/globalContext';\n\nconst { Sider, Content } = Layout;\n\nfunction ChatMain(props) {\n    const globalUser = useContext(GlobalContext.GlobalUser)\n\n    const globalStore = useGlobalStore();\n    const chatStore = useChatStore();\n    const socket = globalStore.socket;\n\n    // const router = useHistory();\n    const { request: getUserInfo } = useMyInfo();\n    const { request: getAllUser } = useUserInfo();\n\n    useEffect(() => {\n        console.log(\"globalUser...\", globalUser)\n        listChange()\n    }, [globalUser])\n\n    const listChange = async () => {\n        globalStore.user.userInfo = (await getUserInfo()).data.data;\n    }\n\n    useEffect(() => {\n\n        socket.on(\"allMessage\", (data) => {\n            let chatRoom = globalStore.user.allUserList[0];\n            const { userId, avatar, nickname, message, time, type } = data;\n            /* 对左侧用户列表进行数据更新 */\n            chatRoom.latestMessage.time = time;\n            chatRoom.latestMessage.message = message;\n            if (userId !== globalStore.user.userInfo.userId) { // 发消息的不是自己\n                chatRoom.latestMessage.message = `${nickname}:${message}`;\n            }\n            /* 当前不在群聊对话框 */\n            if (!chatStore.chat.userId.includes('group')) {\n                console.log(1);\n                chatRoom.unreadMessage++;\n            } else {\n                socket.emit('clearGroupUnreadMessage', { 'userId': globalStore.user.userInfo.userId });\n                chatStore.chat.currentRecords.push({\n                    _id: generateUUID(),\n                    fromId: userId,\n                    nickname: nickname,\n                    avatar: avatar,\n                    message: message,\n                    time: time,\n                    type: type\n                });\n            }\n        });\n        socket.on(\"privateMessage\", (data) => {\n            let chatRoom;\n            const { userId, toId, avatar, nickname, message, time, type } = data;\n            for (let item of globalStore.user.allUserList) {\n                if (item.userId === userId || item.userId === toId) {\n                    chatRoom = item;\n                }\n            }\n            /* 对左侧用户列表进行数据更新 */\n            chatRoom.latestMessage.time = time;\n            chatRoom.latestMessage.message = message;\n            /* 当前不在私聊对话框 */\n            if (chatStore.chat.userId !== userId && chatStore.chat.userId !== toId) {\n                chatRoom.unreadMessage++;\n            } else {\n                globalStore.socket.emit('clearPrivateUnreadMessage', {\n                    'userId': globalStore.user.userInfo.userId,\n                    'fromId': chatStore.chat.userId === userId ? userId : toId,\n                });\n                chatStore.chat.currentRecords.push({\n                    _id: generateUUID(),\n                    fromId: userId,\n                    nickname: nickname,\n                    avatar: avatar,\n                    message: message,\n                    time: time,\n                    type: type\n                });\n            }\n        });\n        socket.on(\"addNewUser\", (data) => {\n            globalStore.user.allUserList.push(data);\n        });\n        socket.on(\"userLogin\", (data) => {\n            globalStore.user.allUserList.forEach((value) => {\n                if (value.userId === data.userId) {\n                    value.isOnline = true;\n                }\n            })\n        });\n        socket.on(\"userLogout\", (data) => {\n            globalStore.user.allUserList.forEach((value) => {\n                if (value.userId === data.userId) {\n                    value.isOnline = false;\n                }\n            })\n        });\n\n        (async () => {\n            globalStore.user.userInfo = (await getUserInfo()).data.data;\n            socket.emit('login', { 'userId': globalStore.user.userInfo.userId });\n            globalStore.user.allUserList = (await getAllUser()).data.data.allUserList;\n            let groupItem = globalStore.user.allUserList.length > 0 ? globalStore.user.allUserList[0] : undefined;\n            if (groupItem && groupItem.latestMessage.fromId) { // 聊天存在\n                if (groupItem.latestMessage.fromId !== globalStore.user.userInfo.userId) {\n                    const latestMessageNickname = groupItem.latestMessage.nickname;\n                    groupItem.latestMessage.message = `${latestMessageNickname}:${groupItem.latestMessage.message}`;\n                }\n            }\n        })();\n\n        //监听浏览器关闭事件(绝对好使，需所有代码放到生命周期mounted中)\n        var userAgent = navigator.userAgent; //取得浏览器的userAgent字符串  \n        var isOpera = userAgent.indexOf(\"Opera\") > -1; //判断是否Opera浏览器  \n        var isIE = userAgent.indexOf(\"compatible\") > -1 && userAgent.indexOf(\"MSIE\") > -1 && !isOpera; //判断是否IE浏览器\n        var isIE11 = userAgent.indexOf(\"rv:11.0\") > -1; //判断是否是IE11浏览器\n        var isEdge = userAgent.indexOf(\"Edge\") > -1 && !isIE; //判断是否IE的Edge浏览器\n        if (!isIE && !isEdge && !isIE11) {//兼容chrome和firefox\n            var _beforeUnload_time = 0, _gap_time = 0;\n            var is_fireFox = navigator.userAgent.indexOf(\"Firefox\") > -1;//是否是火狐浏览器\n            window.onunload = function () {\n                _gap_time = new Date().getTime() - _beforeUnload_time;\n                if (_gap_time <= 5) {\n                    //谷歌浏览器关闭\n                } else {\n                    //谷歌浏览器刷新\n                }\n                socket.emit('disconnection', { 'userId': globalStore.user.userInfo.userId });\n            };\n            window.onbeforeunload = function () {\n                _beforeUnload_time = new Date().getTime();\n                if (is_fireFox) {\n                    //火狐浏览器关闭\n                } else {\n                    //火狐浏览器刷新\n                }\n                socket.emit('disconnection', { 'userId': globalStore.user.userInfo.userId });\n            };\n        }\n        return () => {\n            socket.emit('disconnection', { 'userId': globalStore.user.userInfo.userId });\n            globalStore.socket.close();\n            globalStore.socket = io(socketIp);\n        }\n    }, []);\n\n    return (\n        <Layout className=\"back-layout-wrapper\">\n            <Sider\n                className='chatSider'\n                width={sideWidth}\n            >\n                <WeChatHeader {...props} />\n                <Observer>\n                    {() =>\n                        <SideUserList\n                            allUserList={globalStore.user.allUserList}\n                        />\n                    }\n                </Observer>\n                <ChatGame />\n                <ChatPlayer />\n            </Sider>\n            <Layout\n                style={\n                    {\n                        marginLeft: sideWidth,\n                        backgroundColor: \"#fff\",\n                    }\n                }\n            >\n                <Content\n                    style={{\n                        display: 'flex',\n                        height: '100vh',\n                    }}\n                >\n                    <Observer>\n                        {() => <Switch>\n                            {routes.map((item: any) => {\n                                return (\n                                    <Route\n                                        key={item.path}\n                                        path={item.path}\n                                        exact={item.exact}\n                                        render={props => {\n                                            // document.title = `${item.title}-${siteName}`;\n                                            return <item.component {...props} />;\n                                        }\n                                        } />\n                                );\n                            })}\n                        </Switch>}\n                    </Observer>\n                </Content>\n            </Layout>\n        </Layout>\n    );\n}\n\nexport default ChatMain;\n","import React from 'react';\nimport {Form, Input, Button, message} from 'antd';\nimport {observer} from 'mobx-react-lite';\nimport {useHistory} from 'react-router-dom';\nimport './index.less';\nimport {useLogin} from '@/App/httpClientRequest/useApi';\nimport {setToken} from \"@/App/utils/operatorLocalStorage\";\nimport {useGlobalStore} from \"@/App/store/GlobalStore\";\nimport md5 from 'md5';\n\nconst Login = observer(props => {\n  const globalStore = useGlobalStore();\n  const router = useHistory();\n  const {request: loginRequest, loading} = useLogin();\n\n  // 验证登录表单\n  const pwdValidate = (rule: any, value: string) => {\n    const regular = /^[a-zA-Z0-9]{6,20}$/;\n    if (!value) {\n      return Promise.reject('密码不能为空！');\n    }\n    if (regular.test(value)) {\n      return Promise.resolve();\n    } else {\n      return Promise.reject('密码为 6-20 位数字和字母！');\n    }\n  };\n\n  // 登录请求\n  const loginSubmit = async (values: any) => {\n    values.password = md5(values.password);\n    const res = await loginRequest(values);\n    const resData = res.data;\n    if (resData.code !== '1') {\n      message.error(resData.message);\n    } else {\n      setToken(`Bearer ${resData.token}`);\n      globalStore.user.token = resData.token;\n      router.push('/');\n      message.success('登录成功');\n    }\n  };\n\n  return (\n    <div className=\"login-wrapper\">\n      <div className=\"login-box\">\n        <h1 className='welcome'>欢迎登录</h1>\n        <Form\n          onFinish={loginSubmit}\n        >\n          <Form.Item\n            name='username'\n            rules={[\n              {required: true, message: '账号不能为空！'},\n            ]\n            }\n          >\n            <Input\n              autoComplete='off'\n              placeholder='请输入用户名'\n            />\n          </Form.Item>\n          <Form.Item\n            name='password'\n            rules={[\n              {validator: pwdValidate}\n            ]}\n          >\n            <Input.Password\n              placeholder='请输入 6-20 位数字和字母'\n              autoComplete='off'\n            />\n          </Form.Item>\n          <Form.Item>\n            <Button\n              loading={loading}\n              className='login-btn'\n              type='primary'\n              htmlType='submit'>登录</Button>\n          </Form.Item>\n        </Form>\n        <div className=\"to-register\">\n          <span onClick={() => {\n            router.push('/register')\n          }}>去注册</span>\n        </div>\n      </div>\n    </div>\n  );\n});\n\nexport default Login;\n// function W(CClass) {\n//   return <Consumer>{(rouer)=><CClass {...router}/>}</Consumer>\n// }","import React, {useEffect} from 'react';\nimport {Form, Input, Button, message} from 'antd';\nimport {observer} from 'mobx-react-lite';\nimport {useLocalStore} from \"mobx-react-lite\";\nimport {useHistory} from 'react-router-dom';\nimport './index.less';\nimport {useRegister, useGetAvatar} from '@/App/httpClientRequest/useApi';\nimport md5 from 'md5';\nimport {useGlobalStore} from \"@/App/store/GlobalStore\";\n\ninterface Store {\n  avatarList: string[],\n}\n\nconst Register = observer(props => {\n  const globalStore = useGlobalStore();\n  const socket = globalStore.socket;\n  const router = useHistory();\n  const {request: registerRequest, loading} = useRegister();\n  const {request: getAvatar} = useGetAvatar();\n\n  const store: Store = useLocalStore(() => ({\n    avatarList: [],\n  }));\n\n  useEffect(() => {\n    (async function () {\n      store.avatarList = (await getAvatar()).data.data.avatarList;\n    })();\n  }, []);\n\n  // 验证登录表单\n  const pwdValidate = (rule: any, value: string) => {\n    const regular = /^[a-zA-Z0-9]{6,20}$/;\n    if (!value) {\n      return Promise.reject('密码不能为空！');\n    }\n    if (regular.test(value)) {\n      return Promise.resolve();\n    } else {\n      return Promise.reject('密码为 6-20 位数字和字母！');\n    }\n  };\n\n  // 注册请求\n  const registerSubmit = async (values: any) => {\n    let random = Math.floor(Math.random() * store.avatarList.length);\n    values.password = md5(values.password);\n    values.avatar = store.avatarList[random];\n\n    const res = await registerRequest(values);\n    const resData = res.data;\n    if (resData.code !== '1') {\n      message.error(resData.message);\n    } else {\n      router.push('/login');\n      message.success('注册成功');\n      socket.emit('register');\n    }\n  };\n\n  return (\n    <div className=\"login-wrapper\">\n      <div className=\"login-box\">\n        <h1 className='welcome'>欢迎注册</h1>\n        <Form\n          onFinish={registerSubmit}\n        >\n          <Form.Item\n            name='username'\n            rules={[\n              {required: true, message: '账号不能为空！'},\n            ]\n            }\n          >\n            <Input\n              autoComplete='off'\n              placeholder='请输入用户名'\n            />\n          </Form.Item>\n          <Form.Item\n            name='nickname'\n            rules={[\n              {required: true, message: '昵称不能为空！'},\n            ]\n            }\n          >\n            <Input\n              autoComplete='off'\n              placeholder='请输入昵称'\n            />\n          </Form.Item>\n          <Form.Item\n            name='password'\n            rules={[\n              {validator: pwdValidate}\n            ]}\n          >\n            <Input.Password\n              placeholder='请输入 6-20 位数字和字母'\n              autoComplete='off'\n            />\n          </Form.Item>\n          <Form.Item>\n            <Button\n              loading={loading}\n              className='login-btn'\n              type='primary'\n              htmlType='submit'>注册</Button>\n          </Form.Item>\n        </Form>\n        <div className=\"to-register\">\n          <span onClick={() => {\n            router.push('/login')\n          }}>去登陆</span>\n        </div>\n      </div>\n    </div>\n  );\n});\n\nexport default Register;\n// function W(CClass) {\n//   return <Consumer>{(rouer)=><CClass {...router}/>}</Consumer>\n// }","import React, { useEffect, createContext, useState } from 'react';\nimport { Switch, Route, withRouter, Redirect } from 'react-router-dom';\nimport './index.less';\nimport { siteName } from \"@/common/constant\";\nimport ChatMain from \"@/App/layout/Chat/ChatMain\";\nimport Login from \"@/App/layout/Login\";\nimport Register from \"@/App/layout/Register\";\nimport { getToken } from \"@/App/utils/operatorLocalStorage\";\nimport { ChatStoreProvider } from \"@/App/layout/Chat/ChatStore/ChatStore\";\nimport GlobalContext from '@/App/components/globalContext';\n\nfunction App(props: any) {\n  const [globalInfo, setGlobalInfo] = useState(null)\n  useEffect(() => {\n    /* 捕获全局 reject 并取消报错*/\n    window.addEventListener('unhandledrejection', (e) => {\n      e.preventDefault();\n    });\n  }, []);\n  return (\n    <Switch>\n      <Route path='/login' render={() => {\n        document.title = `登录-${siteName}`;\n        return getToken() ? <Redirect to='/' /> : <Login />;\n      }} />\n      <Route path='/register' render={() => {\n        document.title = `注册-${siteName}`;\n        return <Register />;\n      }} />\n      <Route path='/' render={() => {\n        document.title = `聊天-${siteName}`;\n        return getToken()\n          ?\n          (<ChatStoreProvider>\n            <GlobalContext.GlobalUser.Provider value={globalInfo}>\n              <ChatMain method={setGlobalInfo} />\n            </GlobalContext.GlobalUser.Provider >\n          </ChatStoreProvider>)\n          : <Redirect to='/login' />;\n      }} />\n    </Switch>\n  );\n}\n\nexport default withRouter(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. Index is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport './index.less';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport { BrowserRouter } from 'react-router-dom';\nimport { StoreProvider } from \"@/App/store/GlobalStore\";\nReactDOM.render(\n  <BrowserRouter>\n    <StoreProvider>\n      <App />\n    </StoreProvider>\n  </BrowserRouter>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}