/*! For license information please see main.09f535cc.chunk.js.LICENSE.txt */
(this["webpackJsonpweb-chat"]=this["webpackJsonpweb-chat"]||[]).push([[0],{110:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return l}));var a=n(0),r=n.n(a),c=n(43),s={userId:"",nickname:"",avatar:"",currentRecords:[],recordsListRef:r.a.createRef()};function u(){return{chat:s}}var o=r.a.createContext({}),i=function(e){var t=e.children,n=Object(c.c)(u);return r.a.createElement(o.Provider,{value:n}," ",t)},l=function(){var e=r.a.useContext(o);if(!e)throw new Error("useStore must be used within a StoreProvider");return e}},21:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"g",(function(){return c})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return o}));var a="WebChat",r="http://1.12.246.138:3000",c="http://1.12.246.138:4000",s="http://1.12.246.138:3000/netclound",u="http://1.12.246.138:3000/migumusic",o="http://1.12.246.138:3000/qqmusic",i=400},25:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(9),r=n.n(a),c=(n(109),n(41)),s=n(74),u=n(23),o=n(26),i=n(133),l=n.n(i),f=n(40),d=n(0),m=n(49),p=n(33);l.a.create({timeout:3e3}).defaults.headers.post["Content-Type"]="application/json";var h={400:"\u8bf7\u6c42\u53c2\u6570\u9519\u8bef",401:"\u6743\u9650\u4e0d\u8db3, \u8bf7\u91cd\u65b0\u767b\u5f55",403:"\u670d\u52a1\u5668\u62d2\u7edd\u672c\u6b21\u8bbf\u95ee",404:"\u8bf7\u6c42\u8d44\u6e90\u672a\u627e\u5230",500:"\u5185\u90e8\u670d\u52a1\u5668\u9519\u8bef",501:"\u670d\u52a1\u5668\u4e0d\u652f\u6301\u8be5\u8bf7\u6c42\u4e2d\u4f7f\u7528\u7684\u65b9\u6cd5",502:"\u7f51\u5173\u9519\u8bef",504:"\u7f51\u5173\u8d85\u65f6"},b=function(e,t){var n=Object(d.useState)(!1),a=Object(o.a)(n,2),i=a[0],b=a[1],v=Object(m.b)(),g=Object(p.g)();return{request:Object(d.useCallback)(function(){var n=Object(u.a)(r.a.mark((function n(a,u){var o,i,d,m;return r.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=u?"".concat(e,"/").concat(u):e,(i=Object(f.b)())?l.a.defaults.headers.Authorization=i:delete l.a.defaults.headers.Authorization,b(!0),n.prev=4,console.log(o,a),"get"!==t.method){n.next=12;break}return n.next=9,l()(Object(s.a)({url:o,params:a},t));case 9:d=n.sent,n.next=15;break;case 12:return n.next=14,l()(Object(s.a)({url:o,data:a},t));case 14:d=n.sent;case 15:return n.abrupt("return",d);case 18:if(n.prev=18,n.t0=n.catch(4),!n.t0.response){n.next=27;break}return m=n.t0.response.status in h?h[n.t0.response.status]:n.t0.response.data.message,c.b.error(m),401===n.t0.response.status&&(v.logout(),g.push("/login")),n.abrupt("return",Promise.reject(m));case 27:return c.b.error("\u8bf7\u6c42\u8d85\u65f6\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5"),n.abrupt("return",Promise.reject("\u8bf7\u6c42\u8d85\u65f6\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5"));case 29:return n.prev=29,b(!1),n.finish(29);case 32:case"end":return n.stop()}}),n,null,[[4,18,29,32]])})));return function(e,t){return n.apply(this,arguments)}}(),[e,t]),loading:i}}},313:function(e,t,n){e.exports=n(579)},318:function(e,t,n){},319:function(e,t,n){},322:function(e,t,n){},343:function(e,t){},357:function(e,t,n){},40:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return u}));function a(){return localStorage.getItem("authorization")}function r(e){return localStorage.setItem("authorization",e)}function c(){return localStorage.removeItem("authorization")}function s(e){return localStorage.setItem("netclounduserid",e)}function u(){return localStorage.getItem("netclounduserid")}},443:function(e,t,n){},444:function(e,t,n){},445:function(e,t,n){},47:function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"j",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"k",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return h}));var a=n(25),r=n(21),c=function(){return Object(a.a)("".concat(r.c,"/api/login"),{method:"post"})},s=function(){return Object(a.a)("".concat(r.c,"/api/register"),{method:"post"})},u=function(){return Object(a.a)("".concat(r.c,"/api/getAvatar"),{method:"get"})},o=function(){return Object(a.a)("".concat(r.c,"/api/setavatar"),{method:"post"})},i=function(){return Object(a.a)("".concat(r.c,"/api/getUserInfo"),{method:"get"})},l=function(){return Object(a.a)("".concat(r.c,"/api/getAllUser"),{method:"get"})},f=function(){return Object(a.a)("".concat(r.c,"/api/getRoomRecords"),{method:"get"})},d=function(){return Object(a.a)("".concat(r.c,"/api/getPrivateRecords"),{method:"get"})},m=function(){return Object(a.a)("".concat(r.c,"/api/getFacebag"),{method:"get"})},p=function(){return Object(a.a)("".concat(r.c,"/api/deleteFacebag"),{method:"delete"})},h=function(){return Object(a.a)("".concat(r.c,"/api/getMusic"),{method:"get"})}},49:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var a=n(0),r=n.n(a),c=n(43),s=n(40),u=n(165),o=n.n(u),i=n(21),l={token:Object(s.b)(),userInfo:{userId:"",nickname:"",avatar:""},allUserList:[]};function f(){return{user:l,socket:o()(i.g),logout:function(){Object(s.c)(),this.user.token=""}}}var d=r.a.createContext({}),m=function(e){var t=e.children,n=Object(c.c)(f);return r.a.createElement(d.Provider,{value:n}," ",t)},p=function(){var e=r.a.useContext(d);if(!e)throw new Error("useStore must be used within a StoreProvider");return e}},540:function(e,t,n){},555:function(e,t,n){},564:function(e,t,n){},565:function(e,t,n){},572:function(e,t,n){},573:function(e,t,n){},575:function(e,t,n){},578:function(e,t,n){},579:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(32),s=n.n(c),u=(n(318),n(26)),o=n(33),i=(n(319),n(21)),l=n(164),f=n(9),d=n.n(f),m=n(23),p=(n(320),n(148)),h=(n(322),n(165)),b=n.n(h),v=n(43),g=n(143),y=n(144),O=n(307),E=n(305),j=n(298),x=n.n(j),k=n(220),w=n.n(k),I=(n(348),function(e){Object(O.a)(n,e);var t=Object(E.a)(n);function n(e){var a;return Object(g.a)(this,n),a=t.call(this,e),w.a.start(),a}return Object(y.a)(n,[{key:"componentDidMount",value:function(){w.a.done()}},{key:"render",value:function(){return r.a.createElement("div",null)}}]),n}(a.Component)),S=[{path:"/",exact:!0,auth:!0,component:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I;return x()({loader:e,loading:t})}((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,609))}))}],N=(n(109),n(41)),C=(n(149),n(95)),q=(n(311),n(227)),M=(n(162),n(88)),U=n(140),L=(n(357),n(49)),P=n(47),z=n(309),R=n(40);var A=function(e){var t=Object(L.b)(),n=Object(o.g)(),c=Object(a.useState)(!1),s=Object(u.a)(c,2),i=s[0],l=s[1],f=Object(a.useState)([]),p=Object(u.a)(f,2),h=p[0],b=p[1],g=Object(a.useState)(t.user.userInfo.avatar),y=Object(u.a)(g,2),O=y[0],E=y[1],j=Object(P.b)().request,x=Object(P.j)().request,k={name:"avatar",multiple:!0,showUploadList:!1,action:"http://1.12.246.138:3000/api/uploadAvatar",headers:{Authorization:Object(R.b)()},onChange:function(e){console.log(e);var t=e.file;if("done"===t.status){var n=t.response.filename;console.log(n);var a=Object(U.a)(h);a.push("http://1.12.246.138:4000/avatar/".concat(n)),b(a)}}};function w(){return(w=Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:t=e.sent.data.data,b(t.avatarList),l(!0);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(m.a)(d.a.mark((function n(){var a;return d.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log(O,t.user.userInfo.nickname),""===O||O===t.user.userInfo.avatar){n.next=7;break}return n.next=4,x({nickName:t.user.userInfo.nickname,avatar:O});case 4:a=n.sent,e.method(a),N.b.success(a.data.message);case 7:l(!1);case 8:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return r.a.createElement(v.a,null,(function(){return r.a.createElement("div",{className:"chat-header-wrapper"},r.a.createElement(C.a,{title:"\u5934\u50cf\u9009\u62e9",centered:!0,visible:i,onCancel:function(){return l(!1)},onOk:function(){return function(){return I.apply(this,arguments)}()},cancelButtonProps:{style:{display:"none"}},width:1e3},r.a.createElement("div",null,h.map((function(e){return r.a.createElement("div",{style:{cursor:"pointer",display:"inline-block",margin:"10px",border:"2px solid ".concat(O===e?"#1890ff":"transparent ")},key:e,onClick:function(){return function(e){E(e)}(e)}},r.a.createElement(M.a,{size:80,src:e}))})),r.a.createElement(q.a,k,r.a.createElement("div",{style:{cursor:"pointer",display:"inline-block",margin:"10px",border:"2px solid transparent"}},r.a.createElement(M.a,{size:80,icon:r.a.createElement(z.a,null)}))))),r.a.createElement("div",{className:"user-info-show"},r.a.createElement("div",{className:"user-info"},r.a.createElement("img",{className:"user-avatar",onClick:function(){!function(){w.apply(this,arguments)}()},src:t.user.userInfo.avatar,alt:""}),r.a.createElement("span",{className:"nickname"},t.user.userInfo.nickname)),r.a.createElement("div",{className:"user-operator"},r.a.createElement("ul",{className:"operator-list"},r.a.createElement("li",{className:"operator-item",onClick:Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.logout(),n.push("/"),N.b.success("\u9000\u51fa\u6210\u529f");case 3:case"end":return e.stop()}}),e)})))},"\u9000\u51fa\u767b\u5f55")))))}))},T=(n(443),n(444),n(110));n(445);var D=function(e){return r.a.createElement("div",{className:"my-badge"},e.children)},B=n(225),_=n.n(B),F=Object(v.b)((function(e){var t=Object(T.b)(),n=Object(L.b)(),a=Object(P.i)().request,c=Object(P.g)().request,s=function(){var r=Object(m.a)(d.a.mark((function r(){var s,u,o,i,f,m;return d.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s=e.userId,u=e.nickname,o=e.avatar,t.chat.userId=s,t.chat.nickname=u,t.chat.avatar=o,!s.includes("group")){r.next=12;break}return n.socket.emit("clearGroupUnreadMessage",{userId:n.user.userInfo.userId}),n.user.allUserList[0].unreadMessage=0,r.next=9,a();case 9:t.chat.currentRecords=r.sent.data.data.allRoomRecords,r.next=18;break;case 12:n.socket.emit("clearPrivateUnreadMessage",{userId:n.user.userInfo.userId,fromId:s}),i=Object(l.a)(n.user.allUserList);try{for(i.s();!(f=i.n()).done;)(m=f.value).userId===s&&(m.unreadMessage=0)}catch(d){i.e(d)}finally{i.f()}return r.next=17,c({fromId:s});case 17:t.chat.currentRecords=r.sent.data.data.privateRecords;case 18:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return r.a.createElement("li",{className:"user-list-item".concat(e.userId===t.chat.userId?" active":""),onClick:s},r.a.createElement("div",{className:"avatar avatar-".concat(e.isOnline?"online":"offline")},r.a.createElement("img",{src:e.avatar,alt:""})),r.a.createElement("div",{className:"contacts-content"},r.a.createElement("div",{className:"contacts-info"},r.a.createElement("span",{className:"chat-name"},e.nickname),r.a.createElement("div",{className:"chat-time"},e.latestMessage.time)),r.a.createElement("div",{className:"contacts-texts"},r.a.createElement("p",{className:"text-truncate"},function(e){switch(e.type){case"img":return"[\u56fe\u7247]";case"facebag":return"[\u52a8\u753b\u8868\u60c5]";default:for(var t="",n=!1,a=_.a.createEditorState(e.message).toRAW(!0),r=0;r<a.blocks.length;r++)if(a.blocks[r].text&&"atomic"!==a.blocks[r].type&&(t+=a.blocks[r].text.replace(/<\/?.+?>/g,"").replace(/[\r\n]/g,"")).length>50){t=t.slice(0,50)+"\u2026\u2026";break}for(var c in a.entityMap)if("EMBED"!==a.entityMap[c].type){n=!0;break}return t||n&&"[\u56fe\u7247]"}}(e.latestMessage)," "),0!==e.unreadMessage?r.a.createElement(D,null,e.unreadMessage):null)))})),G=Object(v.b)((function(e){return Object(a.useEffect)((function(){})),r.a.createElement("ul",{className:"all-user-list hidden-scrollbar"},e.allUserList.map((function(e){return r.a.createElement(F,Object.assign({key:e.userId+e.time},e))})))})),H=(n(76),n(28)),V=n(74),W=n(302),Y=n.n(W),X=n(25),K=function(){return Object(X.a)("".concat(i.d,"/song/url"),{method:"get"})},$=function(){return Object(X.a)("".concat(i.d,"/lyric"),{method:"get"})},J=function(){return Object(X.a)("".concat(i.d,"/cloudsearch"),{method:"get"})},Q=function(){return Object(X.a)("".concat(i.d,"/song/detail"),{method:"get"})};n(540);function Z(e){return r.a.createElement(C.a,{title:"\u767b\u5f55\u7f51\u6613\u4e91",centered:!0,destroyOnClose:!0,visible:e.visiable,cancelButtonProps:{style:{display:"none"}},okButtonProps:{style:{display:"none"}},width:800,onCancel:function(){e.setVisiable()}},r.a.createElement(ee,null))}function ee(){var e,t,n=Object(a.useState)("http://1.12.246.138:4000/picture/loading.gif"),c=Object(u.a)(n,2),s=c[0],o=c[1],l=Object(a.useState)("\u4f7f\u7528\u7f51\u6613\u4e91App\u626b\u7801\u767b\u5f55"),f=Object(u.a)(l,2),p=f[0],h=f[1],b=Object(X.a)("".concat(i.d,"/login/qr/key"),{method:"get"}).request,v=Object(X.a)("".concat(i.d,"/login/qr/create"),{method:"get"}).request,g=Object(X.a)("".concat(i.d,"/login/qr/check"),{method:"get"}).request,y=Object(X.a)("".concat(i.d,"/login/status"),{method:"get"}).request;function O(){return E.apply(this,arguments)}function E(){return(E=Object(m.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b({timerstamp:Date.now()});case 2:return t=e.sent.data.data,console.log(t),e.next=6,v({key:t.unikey,qrimg:!0,timerstamp:Date.now()});case 6:n=e.sent.data.data,console.log(n),o(n.qrimg),j(t.unikey);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(n){e=setInterval(Object(m.a)(d.a.mark((function a(){var r,c;return d.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,g({key:n,timerstamp:Date.now()});case 2:r=a.sent.data,console.log(r),h(r.message),a.t0=r.code,a.next=800===a.t0?8:801===a.t0?12:802===a.t0?13:803===a.t0?14:22;break;case 8:return h("\u4e8c\u7ef4\u7801\u8fc7\u671f\uff0c\u8bf7\u70b9\u51fb\u91cd\u65b0\u52a0\u8f7d"),t=800,clearInterval(e),a.abrupt("break",22);case 12:case 13:return a.abrupt("break",22);case 14:return h("\u6388\u6743\u767b\u5f55\u6210\u529f"),clearInterval(e),a.next=18,y({timerstamp:Date.now()});case 18:return c=a.sent.data.data,console.log(c),Object(R.d)(c.account.id),a.abrupt("break",22);case 22:case"end":return a.stop()}}),a)}))),5e3)}return Object(a.useEffect)((function(){return O(),function(){clearInterval(e)}}),[]),r.a.createElement("div",{className:"qrlogin-container"},r.a.createElement("h3",null,"\u626b\u7801\u767b\u9646"),r.a.createElement("img",{onClick:function(){800===t&&O()},src:s}),r.a.createElement("div",null,p))}n(296);var te=n(181),ne=(n(581),n(304)),ae=(n(582),n(222)),re=n(584),ce=n(585);n(555);function se(e){var t=Object(X.a)("".concat(i.d,"/user/playlist"),{method:"get"}).request,n=(Q().request,Object(a.useState)([])),c=Object(u.a)(n,2),s=c[0],o=c[1],l=Object(a.useState)(null),f=Object(u.a)(l,2),p=f[0],h=f[1];return Object(a.useEffect)((function(){return e.visiable&&Object(m.a)(d.a.mark((function e(){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t({uid:Object(R.a)()});case 2:n=e.sent.data,console.log(n),o(n.playlist);case 5:case"end":return e.stop()}}),e)})))(),function(){}}),[e.visiable]),r.a.createElement(C.a,{title:"\u6211\u7684\u6b4c\u5355",centered:!0,destroyOnClose:!0,visible:e.visiable,cancelButtonProps:{style:{display:"none"}},okButtonProps:{style:{display:"none"}},width:750,bodyStyle:{minHeight:"400px",maxHeight:"600px",overflowY:"scroll"},onCancel:function(){e.setVisiable()}},null===p&&r.a.createElement("div",{className:"play-list-container"},s.map((function(e){return r.a.createElement(ae.a,{key:e.id,hoverable:!0,className:"play-list-card",cover:r.a.createElement("img",{onClick:function(){h(e.id)},src:e.coverImgUrl}),actions:[r.a.createElement("div",{className:"card-action-item"},"\u6807\u7b7e\uff1a",e.tags),r.a.createElement("div",{className:"card-action-item"},"\u6b4c\u66f2\uff1a",e.trackCount),r.a.createElement("div",{className:"card-action-item"},"\u64ad\u653e\uff1a",e.playCount)]},r.a.createElement(ae.a.Meta,{avatar:r.a.createElement(M.a,{src:e.creator.avatarUrl}),title:e.name,description:e.description}))}))),null!==p&&r.a.createElement(ue,Object.assign({},e,{curPlayListId:p,onBack:function(){return h(null)}})))}function ue(e){var t=[{title:"\u97f3\u4e50\u6807\u9898",dataIndex:"name",key:"name"},{title:"\u6b4c\u624b",key:"artist",render:function(e){return r.a.createElement("div",{key:"artist"},e.ar[0].name)}},{title:"\u4e13\u8f91",key:"album",render:function(e){return r.a.createElement("div",{key:"album"},e.al.name)}},{title:"\u65f6\u957f",key:"duration",render:function(e){var t=parseInt(e.dt%3600/60+""),n=Math.ceil(e.dt%60);return r.a.createElement("div",{key:"duration"},t,":",n)}},{title:"\u64cd\u4f5c",key:"action",width:"80px",render:function(e){return r.a.createElement("div",{key:"duration"},r.a.createElement(re.a,{onClick:function(){return function(e){return j.apply(this,arguments)}(e.id)}}),r.a.createElement(ce.a,{onClick:function(){return function(e){return x.apply(this,arguments)}(e.id)}}))}}],n=Q().request,c=Object(X.a)("".concat(i.d,"/playlist/detail"),{method:"get"}).request,s=K().request,o=$().request,l=Object(a.useState)(null),f=Object(u.a)(l,2),p=f[0],h=f[1];function b(e){return v.apply(this,arguments)}function v(){return(v=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s({id:t});case 2:return n=e.sent.data.data,console.log(n),e.abrupt("return",n[0].url);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o({id:t});case 2:return n=e.sent.data,console.log(n),e.abrupt("return",n.lrc.lyric);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){return E.apply(this,arguments)}function E(){return(E=Object(m.a)(d.a.mark((function e(t){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({ids:t});case 2:return a=e.sent.data.songs[0],e.abrupt("return",{name:a.name,artist:a.ar[0].name,url:"",cover:a.al.picUrl,lrc:"",theme:""});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return(j=Object(m.a)(d.a.mark((function t(n){var a;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O(n);case 2:return a=t.sent,t.next=5,b(n);case 5:return a.url=t.sent,t.next=8,g(n);case 8:a.lrc=t.sent,e.player.list.add(a),console.log(a);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(){return(x=Object(m.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){Object(m.a)(d.a.mark((function t(){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c({id:e.curPlayListId});case 2:n=t.sent.data,h(n);case 4:case"end":return t.stop()}}),t)})))()}),[e.curPlayListId]),r.a.createElement("div",{className:"play-list-detail"},r.a.createElement(ne.a,{onBack:function(){e.onBack()},title:null===p||void 0===p?void 0:p.playlist.name,subTitle:null===p||void 0===p?void 0:p.playlist.description}),null!==p&&r.a.createElement(te.a,{rowKey:"id",columns:t,dataSource:p.playlist.tracks}))}n(219);var oe=n(92),ie=(n(292),n(101)),le=(n(562),n(193)),fe=function(){return Object(X.a)("".concat(i.a,"/search"),{method:"get"})},de=function(){return Object(X.a)("".concat(i.b,"/search"),{method:"get"})},me=r.a.forwardRef((function(e,t){var n=J().request,r=fe().request,c=de().request,s=K().request,u=Object(X.a)("".concat(i.a,"/song"),{method:"get"}).request,o=Object(X.a)("".concat(i.b,"//song/url"),{method:"get"}).request,l=$().request,f=(Object(X.a)("".concat(i.a,"/lyric"),{method:"get"}).request,Object(X.a)("".concat(i.b,"/lyric"),{method:"get"}).request);function p(e,t){return h.apply(this,arguments)}function h(){return(h=Object(m.a)(d.a.mark((function e(t,a){var s,u,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=[],o={},e.t0=t,e.next="1"===e.t0?4:"2"===e.t0?9:"3"===e.t0?14:19;break;case 4:return e.next=6,n({keywords:a});case 6:return(u=e.sent.data.result)!=={}&&u.songs.forEach((function(e){o.albumname=e.al.name,o.artist=e.ar[0].name,o.id=e.id,o.name=e.name,o.cover=e.al.picUrl,s.push(o),o={}})),e.abrupt("break",19);case 9:return e.next=11,r({keyword:a});case 11:return(u=e.sent.data.data).list.forEach((function(e){o.albumname=e.album.name,o.artist=e.artists[0].name,o.id=e.id,o.name=e.name,o.cover=e.album.picUrl,s.push(o),o={}})),e.abrupt("break",19);case 14:return e.next=16,c({key:a});case 16:return(u=e.sent.data.data).list.forEach((function(e){o.albumname=e.albumname,o.artist=e.singer[0].name,o.id=e.songmid,o.name=e.songname,o.cover="",s.push(o),o={}})),e.abrupt("break",19);case 19:return e.abrupt("return",s);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t){return v.apply(this,arguments)}function v(){return(v=Object(m.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="",e.t0=t,e.next="1"===e.t0?4:"2"===e.t0?8:"3"===e.t0?12:16;break;case 4:return e.next=6,s({id:Number(n)});case 6:return a=e.sent.data.data[0].url,e.abrupt("break",16);case 8:return e.next=10,u({cid:n});case 10:return a=e.sent.data.data[320],e.abrupt("break",16);case 12:return e.next=14,o({id:n});case 14:return a=e.sent.data.data,e.abrupt("break",16);case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e,t){return y.apply(this,arguments)}function y(){return(y=Object(m.a)(d.a.mark((function e(t,n){var a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a="",e.t0=t,e.next="1"===e.t0?4:"2"===e.t0?8:"3"===e.t0?12:16;break;case 4:return e.next=6,l({id:Number(n)});case 6:return a=e.sent.data.data.lrc.lyuic,e.abrupt("break",16);case 8:return e.next=10,u({cid:n});case 10:return a=e.sent.data.data.lyric,e.abrupt("break",16);case 12:return e.next=14,f({songmid:n});case 14:return a=e.sent.data.data.lyric,e.abrupt("break",16);case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useImperativeHandle)(t,(function(){return{SearchSong:p,SongUrl:b,SongLrc:g}})),null}));n(564);function pe(e){return r.a.createElement(C.a,{title:"daily"===e.child?"\u6bcf\u65e5\u63a8\u8350":"\u6b4c\u66f2\u641c\u7d22",centered:!0,destroyOnClose:!0,visible:e.visiable,cancelButtonProps:{style:{display:"none"}},okButtonProps:{style:{display:"none"}},width:800,bodyStyle:{minHeight:"400px",maxHeight:"600px",overflowY:"scroll"},onCancel:function(){e.setVisiable()}},"daily"===e.child&&r.a.createElement(he,{player:e.player}),"search"===e.child&&r.a.createElement(be,{player:e.player}))}function he(e){var t=Object(a.useState)([]),n=Object(u.a)(t,2),c=n[0],s=n[1],o=Object(X.a)("".concat(i.d,"/recommend/songs"),{method:"get"}).request,l=K().request,f=$().request;function p(e){return{name:e.name,artist:e.ar[0].name,url:"",cover:e.al.picUrl,lrc:"",theme:""}}function h(e){return b.apply(this,arguments)}function b(){return(b=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l({id:t});case 2:return n=e.sent.data.data,console.log(n),e.abrupt("return",n[0].url);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return g.apply(this,arguments)}function g(){return(g=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f({id:t});case 2:return n=e.sent.data,console.log(n),e.abrupt("return",n.lrc.lyric);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(m.a)(d.a.mark((function t(n){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:O(n),setTimeout((function(){var t=e.player.list.audios.length-1;console.log(e.player.list.audios,t),e.player.list.switch(t),e.player.play()}),1e3);case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(e){return E.apply(this,arguments)}function E(){return(E=Object(m.a)(d.a.mark((function t(n){var a,r,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(e),t.next=3,h(n.id);case 3:return a=t.sent,t.next=6,v(n.id);case 6:r=t.sent,(c=p(n)).url=a,c.lrc=r,e.player.list.add(c);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(a.useEffect)((function(){return Object(m.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o({uid:Object(R.a)(),timerstamp:Date.now()});case 2:t=e.sent.data.data,console.log(t),301===t.code?N.b.warn("\u9700\u8981\u91cd\u65b0\u626b\u7801\u767b\u5f55"):s(t.dailySongs);case 5:case"end":return e.stop()}}),e)})))(),function(){}}),[]),r.a.createElement(le.b,{className:"daily-song",itemLayout:"horizontal",dataSource:c,header:r.a.createElement("div",{className:"daily-song-header"},r.a.createElement("div",{className:"header-name"},"\u97f3\u4e50\u6807\u9898"),r.a.createElement("div",{className:"header-artist"},"\u6b4c\u624b"),r.a.createElement("div",{className:"header-action"},"\u64cd\u4f5c")),renderItem:function(e){return r.a.createElement(le.b.Item,null,r.a.createElement(le.b.Item.Meta,{avatar:r.a.createElement(M.a,{src:e.al.picUrl}),title:r.a.createElement("div",{className:"song-title-bar"},r.a.createElement("div",{className:"song-name"},e.name),r.a.createElement("div",{className:"song-artist"},e.ar[0].name),r.a.createElement("div",{className:"song-action-right"},r.a.createElement(H.a,{onClick:function(){!function(e){y.apply(this,arguments)}(e)}},"\u64ad\u653e"),r.a.createElement(H.a,{onClick:function(){O(e)}},"\u52a0\u5165\u5217\u8868")))}))}})}function be(e){J().request,de().request,fe().request,K().request,$().request,Q().request,Object(X.a)("".concat(i.c,"/api/audio/save"),{method:"post"}).request,Object(L.b)();var t=Object(a.useState)("\u5728\u7f51\u6613\u4e91\u641c\u7d22"),n=Object(u.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)("1"),l=Object(u.a)(o,2),f=l[0],p=l[1],h=r.a.createRef(),b=[{title:"\u97f3\u4e50\u6807\u9898",dataIndex:"name",key:"name"},{title:"\u6b4c\u624b",key:"artist",dataIndex:"artist"},{title:"\u4e13\u8f91",key:"albumname",dataIndex:"albumname"},{title:"\u64cd\u4f5c",key:"action",width:"100px",render:function(e){return r.a.createElement("div",{key:"duration"},r.a.createElement(re.a,{onClick:function(){return function(e){return j.apply(this,arguments)}(e)}}),r.a.createElement(ce.a,{onClick:function(){return function(e){return x.apply(this,arguments)}(e.id)}}))}}],v=Object(a.useState)([]),g=Object(u.a)(v,2),y=g[0],O=g[1];function E(){return(E=Object(m.a)(d.a.mark((function e(t){var n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.current.SearchSong(f,t);case 2:n=e.sent,O(n);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(){return(j=Object(m.a)(d.a.mark((function t(n){var a,r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.current.SongUrl(f,n.id);case 2:return a=t.sent,t.next=5,h.current.SongLrc(f,n.id);case 5:r=t.sent,n.url=a,n.lrc=r,e.player.list.add(n);case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function x(){return(x=Object(m.a)(d.a.mark((function e(t){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:N.b.info("\u5c0f\u54e5\u6b63\u5728\u52aa\u529b\u52a0\u73ed\u5f00\u53d1\ud83d\ude37\ud83d\ude37~~~");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return r.a.createElement("div",null,r.a.createElement(me,{ref:h}),r.a.createElement(ie.a,{onChange:function(e){var t="";switch(e){case"1":t="\u5728\u7f51\u6613\u4e91\u641c\u7d22";break;case"2":t="\u5728\u54aa\u5495\u97f3\u4e50\u641c\u7d22";break;case"3":return void N.b.info("\u6682\u4e0d\u652f\u6301\u8001\u9a6c\ud83e\udd2a\ud83e\udd2a~~~")}s(t),p(e)},defaultActiveKey:"1",type:"card",size:"middle"},r.a.createElement(ie.a.TabPane,{tab:"\u7f51\u6613\u4e91",key:"1"}),r.a.createElement(ie.a.TabPane,{tab:"\u54aa\u5495\u97f3\u4e50",key:"2"}),r.a.createElement(ie.a.TabPane,{tab:"QQ\u97f3\u4e50",key:"3"})),r.a.createElement(oe.a.Search,{placeholder:c,onSearch:function(e){return E.apply(this,arguments)},enterButton:!0}),r.a.createElement(te.a,{rowKey:"id",columns:b,dataSource:y}))}n(565),n(566);var ve=function(){function e(t){Object(g.a)(this,e),this.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)},this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)}return Object(y.a)(e,[{key:"clear",value:function(){this.context.clearRect(0,0,this.width,this.height)}},{key:"update",value:function(e){this.context.putImageData(e,0,0)}},{key:"getPixelCount",value:function(){return this.width*this.height}},{key:"getImageData",value:function(){return this.context.getImageData(0,0,this.width,this.height)}}]),e}(),ge=function(){function e(){Object(g.a)(this,e)}return Object(y.a)(e,[{key:"convertColorRgb",value:function(e){return e.length?e[0].length?e.reduce((function(e,t){return t.length?(e.push("rgb(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")")),e):e}),[]):"rgb(".concat(e[0],", ").concat(e[1],", ").concat(e[2],")"):e}},{key:"getColor",value:function(e,t){return this.getPalette(e,5,t)[0]}},{key:"getPalette",value:function(e,t,n){("undefined"===typeof t||t<2||t>256)&&(t=10),("undefined"===typeof n||n<1)&&(n=10);for(var a,r,c,s,u=new ve(e),o=u.getImageData().data,i=u.getPixelCount(),l=[],f=0;f<i;f+=n)r=o[(a=4*f)+0],c=o[a+1],s=o[a+2],o[a+3]>=125&&(r>250&&c>250&&s>250||l.push([r,c,s]));var d=Oe.quantize(l,t),m=d?d.palette():[];return u.removeCanvas(),m}},{key:"getColorFromUrl",value:function(e,t){return new Promise((function(n,a){if(!e||0===e.length)return a("imgurl is not defind");var r=document.createElement("img"),c=this;r.addEventListener("load",(function(){var e=c.getPalette(r,5,t)[0];n(e)})),r.src=e}))}},{key:"getImageData",value:function(e){return new Promise((function(t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(e){if(200==this.status){for(var n=new Uint8Array(this.response),a=n.length,r=new Array(a),c=0;c<n.length;c++)r[c]=String.fromCharCode(n[c]);var s=r.join(""),u=window.btoa(s);t("data:image/png;base64,"+u)}},n.send()}))}},{key:"getColorAsync",value:function(e,t){var n=this;return this.getImageData(e).then((function(e){return n.getColorFromUrl(e,t)}))}}]),e}();if(!ye)var ye={map:function(e,t){var n={};return t?e.map((function(e,a){return n.index=a,t.call(n,e)})):e.slice()},naturalOrder:function(e,t){return e<t?-1:e>t?1:0},sum:function(e,t){var n={};return e.reduce(t?function(e,a,r){return n.index=r,e+t.call(n,a)}:function(e,t){return e+t},0)},max:function(e,t){return Math.max.apply(null,t?ye.map(e,t):e)}};var Oe=function(){function e(e,t,n){return(e<<10)+(t<<5)+n}function t(e){var t=[],n=!1;function a(){t.sort(e),n=!0}return{push:function(e){t.push(e),n=!1},peek:function(e){return n||a(),void 0===e&&(e=t.length-1),t[e]},pop:function(){return n||a(),t.pop()},size:function(){return t.length},map:function(e){return t.map(e)},debug:function(){return n||a(),t}}}function n(e,t,n,a,r,c,s){this.r1=e,this.r2=t,this.g1=n,this.g2=a,this.b1=r,this.b2=c,this.histo=s}function a(){this.vboxes=new t((function(e,t){return ye.naturalOrder(e.vbox.count()*e.vbox.volume(),t.vbox.count()*t.vbox.volume())}))}function r(t,n){if(n.count()){var a=n.r2-n.r1+1,r=n.g2-n.g1+1,c=n.b2-n.b1+1,s=ye.max([a,r,c]);if(1==n.count())return[n.copy()];var u,o,i,l,f=0,d=[],m=[];if(s==a)for(u=n.r1;u<=n.r2;u++){for(l=0,o=n.g1;o<=n.g2;o++)for(i=n.b1;i<=n.b2;i++)l+=t[e(u,o,i)]||0;f+=l,d[u]=f}else if(s==r)for(u=n.g1;u<=n.g2;u++){for(l=0,o=n.r1;o<=n.r2;o++)for(i=n.b1;i<=n.b2;i++)l+=t[e(o,u,i)]||0;f+=l,d[u]=f}else for(u=n.b1;u<=n.b2;u++){for(l=0,o=n.r1;o<=n.r2;o++)for(i=n.g1;i<=n.g2;i++)l+=t[e(o,i,u)]||0;f+=l,d[u]=f}return d.forEach((function(e,t){m[t]=f-e})),p(s==a?"r":s==r?"g":"b")}function p(e){var t,a,r,c,s,o=e+"1",i=e+"2",l=0;for(u=n[o];u<=n[i];u++)if(d[u]>f/2){for(r=n.copy(),c=n.copy(),s=(t=u-n[o])<=(a=n[i]-u)?Math.min(n[i]-1,~~(u+a/2)):Math.max(n[o],~~(u-1-t/2));!d[s];)s++;for(l=m[s];!l&&d[s-1];)l=m[--s];return r[i]=s,c[o]=r[i]+1,[r,c]}}}return n.prototype={volume:function(e){return this._volume&&!e||(this._volume=(this.r2-this.r1+1)*(this.g2-this.g1+1)*(this.b2-this.b1+1)),this._volume},count:function(t){var n=this.histo;if(!this._count_set||t){var a,r,c,s=0;for(a=this.r1;a<=this.r2;a++)for(r=this.g1;r<=this.g2;r++)for(c=this.b1;c<=this.b2;c++)s+=n[e(a,r,c)]||0;this._count=s,this._count_set=!0}return this._count},copy:function(){return new n(this.r1,this.r2,this.g1,this.g2,this.b1,this.b2,this.histo)},avg:function(t){var n=this.histo;if(!this._avg||t){var a,r,c,s,u=0,o=0,i=0,l=0;for(r=this.r1;r<=this.r2;r++)for(c=this.g1;c<=this.g2;c++)for(s=this.b1;s<=this.b2;s++)u+=a=n[e(r,c,s)]||0,o+=a*(r+.5)*8,i+=a*(c+.5)*8,l+=a*(s+.5)*8;this._avg=u?[~~(o/u),~~(i/u),~~(l/u)]:[~~(8*(this.r1+this.r2+1)/2),~~(8*(this.g1+this.g2+1)/2),~~(8*(this.b1+this.b2+1)/2)]}return this._avg},contains:function(e){var t=e[0]>>3,n=e[1]>>3,a=e[2]>>3;return t>=this.r1&&t<=this.r2&&n>=this.g1&&n<=this.g2&&a>=this.b1&&a<=this.b2}},a.prototype={push:function(e){this.vboxes.push({vbox:e,color:e.avg()})},palette:function(){return this.vboxes.map((function(e){return e.color}))},size:function(){return this.vboxes.size()},map:function(e){for(var t=this.vboxes,n=0;n<t.size();n++)if(t.peek(n).vbox.contains(e))return t.peek(n).color;return this.nearest(e)},nearest:function(e){for(var t,n,a,r=this.vboxes,c=0;c<r.size();c++)((n=Math.sqrt(Math.pow(e[0]-r.peek(c).color[0],2)+Math.pow(e[1]-r.peek(c).color[1],2)+Math.pow(e[2]-r.peek(c).color[2],2)))<t||void 0===t)&&(t=n,a=r.peek(c).color);return a},forcebw:function(){var e=this.vboxes;e.sort((function(e,t){return ye.naturalOrder(ye.sum(e.color),ye.sum(t.color))}));var t=e[0].color;t[0]<5&&t[1]<5&&t[2]<5&&(e[0].color=[0,0,0]);var n=e.length-1,a=e[n].color;a[0]>251&&a[1]>251&&a[2]>251&&(e[n].color=[255,255,255])}},{quantize:function(c,s){if(!c.length||s<2||s>256)return!1;var u=function(t){var n,a,r,c,s=new Array(32768);return t.forEach((function(t){a=t[0]>>3,r=t[1]>>3,c=t[2]>>3,n=e(a,r,c),s[n]=(s[n]||0)+1})),s}(c);u.forEach((function(){0}));var o=function(e,t){var a,r,c,s=1e6,u=0,o=1e6,i=0,l=1e6,f=0;return e.forEach((function(e){a=e[0]>>3,r=e[1]>>3,c=e[2]>>3,a<s?s=a:a>u&&(u=a),r<o?o=r:r>i&&(i=r),c<l?l=c:c>f&&(f=c)})),new n(s,u,o,i,l,f,t)}(c,u),i=new t((function(e,t){return ye.naturalOrder(e.count(),t.count())}));function l(e,t){for(var n,a=1,c=0;c<1e3;)if((n=e.pop()).count()){var s=r(u,n),o=s[0],i=s[1];if(!o)return;if(e.push(o),i&&(e.push(i),a++),a>=t)return;if(c++>1e3)return}else e.push(n),c++}i.push(o),l(i,.75*s);for(var f=new t((function(e,t){return ye.naturalOrder(e.count()*e.volume(),t.count()*t.volume())}));i.size();)f.push(i.pop());l(f,s-f.size());for(var d=new a;f.size();)d.push(f.pop());return d}}}();function Ee(){var e={mini:!1,autoplay:!1,theme:"#90EE90",loop:"all",preload:"auto",volume:.7,mutex:!0,listFolded:!1,listMaxHeight:"100px",lrcType:1},t=Object(P.d)().request,n=Object(X.a)("".concat(i.c,"/api/audio/list"),{method:"get"}).request,c=Object(a.useState)(!1),s=Object(u.a)(c,2),o=s[0],l=s[1],f=Object(a.useState)(!1),p=Object(u.a)(f,2),h=p[0],b=p[1],v=Object(a.useState)(!1),g=Object(u.a)(v,2),y=g[0],O=g[1],E=Object(a.useState)(""),j=Object(u.a)(E,2),x=j[0],k=j[1],w=Object(a.useState)(null),I=Object(u.a)(w,2),S=I[0],C=I[1];return Object(a.useEffect)((function(){var a=new Y.a(Object(V.a)(Object(V.a)({},e),{},{container:document.getElementById("player")}));a.on("listswitch",(function(e){var t=e.index;a.list.audios[t].cover&&function(e,t){var n=new ge,a=e.list.audios[t].cover;n.getColorFromUrl(a,"hex").then((function(n){console.log(n),e.theme(n,t)})).catch((function(e){console.log(e)}))}(a,t)})),C(a),Object(m.a)(d.a.mark((function e(){var r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return r=e.sent.data.data.musicList,e.next=5,n();case 5:c=e.sent.data.data.audioList,a.list.add([].concat(Object(U.a)(r),Object(U.a)(c)));case 7:case"end":return e.stop()}}),e)})))()}),[]),r.a.createElement("div",{className:"chat-player"},r.a.createElement("div",{className:"net-clound-bar"},r.a.createElement(H.a,{onClick:function(){l(!0)}},"\u767b\u5f55"),r.a.createElement(H.a,{onClick:function(){Object(R.a)()?b(!0):N.b.info("\u8bf7\u5148\u8fdb\u884c\u767b\u5f55")}},"\u6211\u7684\u6b4c\u5355"),r.a.createElement(H.a,{onClick:function(){Object(R.a)()?(O(!0),k("daily")):N.b.info("\u8bf7\u5148\u8fdb\u884c\u767b\u5f55")}},"\u65e5\u63a8\u6b4c\u66f2"),r.a.createElement(H.a,{onClick:function(){O(!0),k("search")}},"\u641c\u7d22")),r.a.createElement("div",{id:"player"}),r.a.createElement(Z,{visiable:o,setVisiable:function(){l(!1)}}),r.a.createElement(se,{player:S,visiable:h,setVisiable:function(){b(!1)}}),r.a.createElement(pe,{player:S,child:x,visiable:y,setVisiable:function(){O(!1)}}))}n(570);var je=n(306),xe=(n(289),n(128));n(572);function ke(e){var t,n=Object(a.useState)([]),c=Object(u.a)(n,2),s=c[0],o=c[1],i=Object(a.useState)(!0),l=Object(u.a)(i,2),f=(l[0],l[1],Object(a.useState)("normal")),d=Object(u.a)(f,2),m=(d[0],d[1],Object(a.useState)({countX:18,countY:9,downTime:1e3,boxSize:50,aWay:"left",delayTime:30})),p=Object(u.a)(m,2),h=p[0],b=(p[1],[{s:[[-1,0],[0,0],[1,0],[1,1]],c:"#f98866",p:[1,1],n:"s1-1"},{s:[[1,0],[1,1],[1,2],[0,2]],c:"#f98866",p:[1,1],n:"s1-2"},{s:[[-1,0],[-1,1],[0,1],[1,1]],c:"#f98866",p:[1,1],n:"s1-3"},{s:[[0,0],[0,1],[0,2],[1,0]],c:"#f98866",p:[1,1],n:"s1-4"},{s:[[-1,0],[0,0],[1,0],[-1,1]],c:"#ff420e",p:[1,1],n:"s2-1"},{s:[[0,0],[1,0],[1,1],[1,2]],c:"#ff420e",p:[1,1],n:"s2-2"},{s:[[-1,1],[0,1],[1,1],[1,0]],c:"#ff420e",p:[1,1],n:"s2-3"},{s:[[0,0],[0,1],[0,2],[1,2]],c:"#ff420e",p:[1,1],n:"s2-4"},{s:[[0,0],[1,0],[0,1],[1,1]],c:"#80bd9e",p:[0,0],n:"s3-1"},{s:[[-1,0],[0,0],[1,0],[2,0]],c:"#89da59",p:[0,-2],n:"s4-1"},{s:[[0,0],[0,1],[0,2],[0,3]],c:"#89da59",p:[1,-2],n:"s4-2"},{s:[[0,0],[-1,1],[0,1],[1,1]],c:"#90afc5",p:[0,-1],n:"s5-1"},{s:[[-1,0],[-1,1],[-1,2],[0,1]],c:"#90afc5",p:[1,-1],n:"s5-2"},{s:[[-1,0],[0,0],[1,0],[0,1]],c:"#90afc5",p:[0,-1],n:"s5-3"},{s:[[0,0],[0,1],[0,2],[-1,1]],c:"#90afc5",p:[0,-1],n:"s5-4"},{s:[[-1,0],[0,0],[0,1],[1,1]],c:"#336b87",p:[0,-1],n:"s6-1"},{s:[[0,0],[0,1],[-1,1],[-1,2]],c:"#336b87",p:[0,0],n:"s6-2"},{s:[[0,0],[1,0],[-1,1],[0,1]],c:"#763626",p:[0,0],n:"s7-1"},{s:[[-1,0],[-1,1],[0,1],[0,2]],c:"#763626",p:[0,1],n:"s7-2"}]),v=Object(a.useRef)(0),g=Object(a.useRef)({s:["4-1","5-1","6-1","6-2"],c:"#f98866",n:"s1-1"}),y=Object(a.useRef)([{p:"1-19",s:"static"},{p:"2-19",s:"static"},{p:"3-19",s:"static"},{p:"4-19",s:"static"},{p:"5-19",s:"static"},{p:"6-19",s:"static"},{p:"7-19",s:"static"},{p:"8-19",s:"static"},{p:"9-19",s:"static"}]),O=Object(a.useRef)(0),E=Object(a.useRef)(0),j=Object(a.useRef)(!0),x=function(e){var t=!1,n=g.current.s.filter((function(t){return t===e})),a=y.current.filter((function(t){return t.p===e}));return n.concat(a).length>0&&(t=!0),t},k=function(e){var t="white";return g.current.s.filter((function(t){return t===e})).length>0&&(t=g.current.c),y.current.filter((function(t){return t.p===e})).length>0&&(t="ping"),t},w=function(){for(var e=[],t=1;t<h.countX+1;t++)for(var n=1;n<h.countY+1;n++){var a=String(n)+"-"+String(t),r={id:a,show:x(a),x:n,y:t,color:k(a)};e.push(r)}o(e)},I=function(e){var t=!0;return y.current.forEach((function(n){e.filter((function(e){return e===n.p})).length>0&&(t=!1)})),t},S=function(e){if(!N(e)){var t=Object(V.a)({},g.current),n=b.filter((function(e){return e.n===t.n}))[0],a="right"===e?0:n.p[0],r=t.s.sort();if(Number(r["right"===e?r.length-1:0].split("-")[0])!==("right"===e?h.countY:1)){var c=[];r.forEach((function(t){var n=t.split("-")[0],a=t.split("-")[1];c.push(String(Number(n)+("right"===e?1:-1))+"-"+a)})),O.current<4&&"right"===e&&(O.current+=1),O.current>-4+a&&"left"===e&&(O.current-=1),g.current.s=c,w()}}},N=function(e){var t=!1,n=Object(V.a)({},g.current),a=[];return n.s.forEach((function(t){var n=t.split("-")[0],r=t.split("-")[1];a.push(String(Number(n)+("right"===e?1:-1))+"-"+r)})),a.forEach((function(e){0!==y.current.filter((function(t){return t.p===e})).length&&(t=!0)})),t},C=function(){if(!q()){E.current+=1;var e=Object(V.a)({},g.current).s.sort(),t=[];e.forEach((function(e){var n=e.split("-")[0],a=e.split("-")[1];t.push(n+"-"+String(Number(a)+1))})),g.current.s=t,w()}},q=function(){var e=!1,t=Object(V.a)({},g.current),n=[];t.s.forEach((function(e){var t=e.split("-")[0],a=e.split("-")[1];n.push(t+"-"+String(Number(a)+1))}));var a=[];return n.forEach((function(n){0===y.current.filter((function(e){return e.p===n})).length||e||(t.s.forEach((function(e){var n={p:e,s:"none",c:t.c};a.push(n)})),e=!0)})),e&&M(a),e},M=function(e){j.current=!1,clearInterval(t),y.current=y.current.concat(e),g.current=U(),E.current=0,O.current=0;var n=[];y.current.forEach((function(e){if("static"!==e.s){Number(e.p.split("-")[0]);var t=Number(e.p.split("-")[1]);n[t]||(n[t]=[]),n[t].push(e)}}));var a=[];if(n.forEach((function(e){9===e.length&&(a.push(e),e.forEach((function(e){var t=y.current.findIndex((function(t){return e.p===t.p}));y.current.splice(t,1)})))})),a.length>0){a.forEach((function(e){var t=Number(e[0].p.split("-")[1]);y.current.forEach((function(e,n){var a=Number(e.p.split("-")[1]),r=e.p.split("-")[0];"static"!==e.s&&a<t&&(e.p=r+"-"+String(a+1))}))})),console.log("xca.lengch",a.length,v);switch(a.length){case 1:v.current=v.current+100;break;case 2:v.current=v.current+500;break;case 3:v.current=v.current+1e3;break;case 4:v.current=v.current+5e3}}t=setInterval((function(){C()}),h.downTime),j.current=!0},U=function(){var e=Math.floor(Math.random()*b.length),t=b[e],n=[];return t.s.forEach((function(e){var t=e[0]+5,a=e[1]+1;n.push(String(t)+"-"+String(a))})),{s:n,c:t.c,n:t.n}},L=function(e){"ArrowUp"===e.key&&j.current&&function(){var e=g.current.n,t=b.filter((function(t){return t.n===e}))[0].n,n=t.split("-")[0],a=Number(t.split("-")[1]),r="";if("s3"!==n){"s1"!==n&&"s2"!==n&&"s5"!==n||(r=4===a?1:a+1),"s6"!==n&&"s7"!==n&&"s4"!==n||(r=2===a?1:a+1);var c=b.filter((function(e){return e.n===n+"-"+String(r)}))[0],s=c.s,u=[];s.forEach((function(e){var t=e[0]+5+O.current+("s4"===n||"s5"===n||"s6"===n||"s7"===n?O.current>0?c.p[1]:c.p[0]:0),a=e[1]+1+E.current;u.push(String(t)+"-"+String(a))})),I(u)&&(g.current={s:u,c:c.c,n:n+"-"+String(r)},w())}}(),"ArrowDown"===e.key&&j.current&&C(),"ArrowLeft"===e.key&&j.current&&S("left"),"ArrowRight"===e.key&&j.current&&S("right")};return Object(a.useEffect)((function(){w(),t=setInterval((function(){C()}),h.downTime),document.addEventListener("keydown",L)}),[]),r.a.createElement("div",{style:{width:"100%",height:"100%"},className:"tow-box bg-orange"},r.a.createElement("div",null,r.a.createElement("div",null,"\u5206\u6570\uff1a",v.current),r.a.createElement("div",null,r.a.createElement(H.a,{onClick:function(){g.current={s:["4-1","5-1","6-1","6-2"],c:"#f98866",n:"s1-1"},y.current=[{p:"1-19",s:"static"},{p:"2-19",s:"static"},{p:"3-19",s:"static"},{p:"4-19",s:"static"},{p:"5-19",s:"static"},{p:"6-19",s:"static"},{p:"7-19",s:"static"},{p:"8-19",s:"static"},{p:"9-19",s:"static"}],O.current=0,E.current=0,j.current=!0,v.current=0,w()}},"\u91cd\u4f86")),r.a.createElement("div",null,s.length>0&&r.a.createElement("div",{className:"one-contant",style:{width:h.countY*h.boxSize,height:h.countX*h.boxSize}},s.map((function(e,t){return r.a.createElement("div",{className:"tow-box",key:t,style:{backgroundColor:e.show?e.color:"white",height:h.boxSize,width:h.boxSize}})}))))))}n(573);var we=function(){var e=[{label:"\u4fc4\u7f57\u65af\u65b9\u5757",value:"Tetris"},{label:"\u8d2a\u5403\u86c7",value:"Snake"},{label:"\u5f85\u5b9a",value:"Wait"}],t=Object(a.useState)(""),n=Object(u.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)(""),i=Object(u.a)(o,2),l=i[0],f=i[1];return r.a.createElement("div",null,r.a.createElement(xe.a.Group,{options:e,onChange:function(t){var n,a,r=t.target.value,c=e.filter((function(e){return e.value===r}));s(null===(n=c[0])||void 0===n?void 0:n.value),f(null===(a=c[0])||void 0===a?void 0:a.label)},value:c,optionType:"button"}),r.a.createElement(je.a,{title:l,width:1500,placement:"left",onClose:function(){s("")},visible:""!==c},r.a.createElement("div",{style:{width:"100%",height:"100%",background:"rgba(0,0,0,0)"}},r.a.createElement(ke,{radioValue:c}))))};function Ie(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:7&n|8).toString(16)}))}var Se={GlobalUser:r.a.createContext(null)},Ne=p.a.Sider,Ce=p.a.Content;var qe=function(e){var t=Object(a.useContext)(Se.GlobalUser),n=Object(L.b)(),c=Object(T.b)(),s=n.socket,u=Object(P.f)().request,f=Object(P.k)().request;Object(a.useEffect)((function(){console.log("globalUser...",t),h()}),[t]);var h=function(){var e=Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:n.user.userInfo=e.sent.data.data;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){s.on("allMessage",(function(e){var t=n.user.allUserList[0],a=e.userId,r=e.avatar,u=e.nickname,o=e.message,i=e.time,l=e.type;t.latestMessage.time=i,t.latestMessage.message=o,a!==n.user.userInfo.userId&&(t.latestMessage.message="".concat(u,":").concat(o)),c.chat.userId.includes("group")?(s.emit("clearGroupUnreadMessage",{userId:n.user.userInfo.userId}),c.chat.currentRecords.push({_id:Ie(),fromId:a,nickname:u,avatar:r,message:o,time:i,type:l})):(console.log(1),t.unreadMessage++)})),s.on("privateMessage",(function(e){var t,a,r=e.userId,s=e.toId,u=e.avatar,o=e.nickname,i=e.message,f=e.time,d=e.type,m=Object(l.a)(n.user.allUserList);try{for(m.s();!(a=m.n()).done;){var p=a.value;p.userId!==r&&p.userId!==s||(t=p)}}catch(h){m.e(h)}finally{m.f()}t.latestMessage.time=f,t.latestMessage.message=i,c.chat.userId!==r&&c.chat.userId!==s?t.unreadMessage++:(n.socket.emit("clearPrivateUnreadMessage",{userId:n.user.userInfo.userId,fromId:c.chat.userId===r?r:s}),c.chat.currentRecords.push({_id:Ie(),fromId:r,nickname:o,avatar:u,message:i,time:f,type:d}))})),s.on("addNewUser",(function(e){n.user.allUserList.push(e)})),s.on("userLogin",(function(e){n.user.allUserList.forEach((function(t){t.userId===e.userId&&(t.isOnline=!0)}))})),s.on("userLogout",(function(e){n.user.allUserList.forEach((function(t){t.userId===e.userId&&(t.isOnline=!1)}))})),Object(m.a)(d.a.mark((function e(){var t,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:return n.user.userInfo=e.sent.data.data,s.emit("login",{userId:n.user.userInfo.userId}),e.next=6,f();case 6:n.user.allUserList=e.sent.data.data.allUserList,(t=n.user.allUserList.length>0?n.user.allUserList[0]:void 0)&&t.latestMessage.fromId&&t.latestMessage.fromId!==n.user.userInfo.userId&&(a=t.latestMessage.nickname,t.latestMessage.message="".concat(a,":").concat(t.latestMessage.message));case 9:case"end":return e.stop()}}),e)})))();var e=navigator.userAgent,t=e.indexOf("Opera")>-1,a=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,r=e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1&&!a;if(!a&&!o&&!r){var p=0;navigator.userAgent.indexOf("Firefox");window.onunload=function(){(new Date).getTime()-p,s.emit("disconnection",{userId:n.user.userInfo.userId})},window.onbeforeunload=function(){p=(new Date).getTime(),s.emit("disconnection",{userId:n.user.userInfo.userId})}}return function(){s.emit("disconnection",{userId:n.user.userInfo.userId}),n.socket.close(),n.socket=b()(i.g)}}),[]),r.a.createElement(p.a,{className:"back-layout-wrapper"},r.a.createElement(Ne,{className:"chatSider",width:i.e},r.a.createElement(A,e),r.a.createElement(v.a,null,(function(){return r.a.createElement(G,{allUserList:n.user.allUserList})})),r.a.createElement(we,null),r.a.createElement(Ee,null)),r.a.createElement(p.a,{style:{marginLeft:i.e,backgroundColor:"#fff"}},r.a.createElement(Ce,{style:{display:"flex",height:"100vh"}},r.a.createElement(v.a,null,(function(){return r.a.createElement(o.d,null,S.map((function(e){return r.a.createElement(o.b,{key:e.path,path:e.path,exact:e.exact,render:function(t){return r.a.createElement(e.component,t)}})})))})))))},Me=(n(226),n(75)),Ue=(n(575),n(180)),Le=n.n(Ue),Pe=Object(v.b)((function(e){var t=Object(L.b)(),n=Object(o.g)(),a=Object(P.e)(),c=a.request,s=a.loading,u=function(){var e=Object(m.a)(d.a.mark((function e(a){var r,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.password=Le()(a.password),e.next=3,c(a);case 3:r=e.sent,"1"!==(s=r.data).code?N.b.error(s.message):(Object(R.e)("Bearer ".concat(s.token)),t.user.token=s.token,n.push("/"),N.b.success("\u767b\u5f55\u6210\u529f"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"login-wrapper"},r.a.createElement("div",{className:"login-box"},r.a.createElement("h1",{className:"welcome"},"\u6b22\u8fce\u767b\u5f55"),r.a.createElement(Me.a,{onFinish:u},r.a.createElement(Me.a.Item,{name:"username",rules:[{required:!0,message:"\u8d26\u53f7\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]},r.a.createElement(oe.a,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})),r.a.createElement(Me.a.Item,{name:"password",rules:[{validator:function(e,t){return t?/^[a-zA-Z0-9]{6,20}$/.test(t)?Promise.resolve():Promise.reject("\u5bc6\u7801\u4e3a 6-20 \u4f4d\u6570\u5b57\u548c\u5b57\u6bcd\uff01"):Promise.reject("\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff01")}}]},r.a.createElement(oe.a.Password,{placeholder:"\u8bf7\u8f93\u5165 6-20 \u4f4d\u6570\u5b57\u548c\u5b57\u6bcd",autoComplete:"off"})),r.a.createElement(Me.a.Item,null,r.a.createElement(H.a,{loading:s,className:"login-btn",type:"primary",htmlType:"submit"},"\u767b\u5f55"))),r.a.createElement("div",{className:"to-register"},r.a.createElement("span",{onClick:function(){n.push("/register")}},"\u53bb\u6ce8\u518c"))))})),ze=(n(578),Object(v.b)((function(e){var t=Object(L.b)().socket,n=Object(o.g)(),c=Object(P.h)(),s=c.request,u=c.loading,i=Object(P.b)().request,l=Object(v.c)((function(){return{avatarList:[]}}));Object(a.useEffect)((function(){Object(m.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i();case 2:l.avatarList=e.sent.data.data.avatarList;case 3:case"end":return e.stop()}}),e)})))()}),[]);var f=function(){var e=Object(m.a)(d.a.mark((function e(a){var r,c,u;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Math.floor(Math.random()*l.avatarList.length),a.password=Le()(a.password),a.avatar=l.avatarList[r],e.next=5,s(a);case 5:c=e.sent,"1"!==(u=c.data).code?N.b.error(u.message):(n.push("/login"),N.b.success("\u6ce8\u518c\u6210\u529f"),t.emit("register"));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"login-wrapper"},r.a.createElement("div",{className:"login-box"},r.a.createElement("h1",{className:"welcome"},"\u6b22\u8fce\u6ce8\u518c"),r.a.createElement(Me.a,{onFinish:f},r.a.createElement(Me.a.Item,{name:"username",rules:[{required:!0,message:"\u8d26\u53f7\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]},r.a.createElement(oe.a,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})),r.a.createElement(Me.a.Item,{name:"nickname",rules:[{required:!0,message:"\u6635\u79f0\u4e0d\u80fd\u4e3a\u7a7a\uff01"}]},r.a.createElement(oe.a,{autoComplete:"off",placeholder:"\u8bf7\u8f93\u5165\u6635\u79f0"})),r.a.createElement(Me.a.Item,{name:"password",rules:[{validator:function(e,t){return t?/^[a-zA-Z0-9]{6,20}$/.test(t)?Promise.resolve():Promise.reject("\u5bc6\u7801\u4e3a 6-20 \u4f4d\u6570\u5b57\u548c\u5b57\u6bcd\uff01"):Promise.reject("\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff01")}}]},r.a.createElement(oe.a.Password,{placeholder:"\u8bf7\u8f93\u5165 6-20 \u4f4d\u6570\u5b57\u548c\u5b57\u6bcd",autoComplete:"off"})),r.a.createElement(Me.a.Item,null,r.a.createElement(H.a,{loading:u,className:"login-btn",type:"primary",htmlType:"submit"},"\u6ce8\u518c"))),r.a.createElement("div",{className:"to-register"},r.a.createElement("span",{onClick:function(){n.push("/login")}},"\u53bb\u767b\u9646"))))})));var Re=Object(o.h)((function(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),c=n[0],s=n[1];return Object(a.useEffect)((function(){window.addEventListener("unhandledrejection",(function(e){e.preventDefault()}))}),[]),r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"/login",render:function(){return document.title="\u767b\u5f55-".concat(i.f),Object(R.b)()?r.a.createElement(o.a,{to:"/"}):r.a.createElement(Pe,null)}}),r.a.createElement(o.b,{path:"/register",render:function(){return document.title="\u6ce8\u518c-".concat(i.f),r.a.createElement(ze,null)}}),r.a.createElement(o.b,{path:"/",render:function(){return document.title="\u804a\u5929-".concat(i.f),Object(R.b)()?r.a.createElement(T.a,null,r.a.createElement(Se.GlobalUser.Provider,{value:c},r.a.createElement(qe,{method:s}))):r.a.createElement(o.a,{to:"/login"})}}))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Ae=n(104);s.a.render(r.a.createElement(Ae.a,null,r.a.createElement(L.a,null,r.a.createElement(Re,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[313,1,2]]]);
//# sourceMappingURL=main.09f535cc.chunk.js.map